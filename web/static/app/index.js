import{o as v,c as y,a as e,u as G,i as X,b as p,w as N,d as V,t as l,e as n,R as oe,f as ve,g as K,h as H,n as B,r as b,F as J,j as te,k as Re,l as se,m as we,p as pe,q as ie,v as xe,s as W,x as ke,D as j,y as Se,z as Oe,A as Pe,S as Ne,B as Ve,C as je}from"./vendor.js";const Be=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const u of o)if(u.type==="childList")for(const c of u.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(o){const u={};return o.integrity&&(u.integrity=o.integrity),o.referrerpolicy&&(u.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?u.credentials="include":o.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(o){if(o.ep)return;o.ep=!0;const u=s(o);fetch(o.href,u)}};Be();var Q=(a,t)=>{const s=a.__vccOpts||a;for(const[r,o]of t)s[r]=o;return s};const Ue={},Xe={width:"512",height:"512",version:"1.1",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},He=e("path",{d:"m114.6 507.3c13.82-0.8729 90.06-3.083 106.2-3.079h13.49l2.639-5.293c5.191-10.41 10.35-29.57 13.13-48.74 1.811-12.5 1.488-16.68-1.826-23.56-2.528-5.249-11.04-13.06-20.54-18.86-28.38-17.32-51.21-34.77-76.05-58.12-6.673-6.272-9.377-8.209-16.08-11.53-12.37-6.124-20.36-12.88-29.19-24.7-1.45-1.941-1.795-2.038-4.695-1.334-1.722 0.4182-7.18 0.8166-12.13 0.8854-19.6 0.2722-38.18-7.715-52.49-22.56-15.97-16.57-23.43-35.49-23.41-59.37 0.01786-16.86 3.547-29.88 11.93-44 9.617-16.19 27.39-30.13 43.89-34.41 2.517-0.653 4.748-1.36 4.958-1.571 0.2103-0.2107-0.05169-3.078-0.5816-6.371-1.41-8.759-0.556-21.84 1.997-30.61 7.023-24.1 24.96-41.95 48.52-48.31 11.42-3.082 29.45-2.167 40.42 2.049 0.919 0.3533 1.637-0.7202 2.994-4.474 6.21-17.18 18.79-33.75 33.11-43.62 35.65-24.56 80.99-19.9 111.3 11.44l5.539 5.719 5.025-1.229c2.764-0.6762 9.075-1.428 14.02-1.672 16.17-0.7944 31.64 3.865 45.31 13.64l5.1 3.647 12.55 0.1171c9.984 0.09312 13.77 0.4491 18.49 1.739 29.1 7.945 50.37 32.58 56 64.86 1.354 7.764 1.096 21.6-0.5502 29.5l-0.916 4.394 5.367 7.086c20.1 26.54 25.52 61.05 14.68 93.52-7.862 23.55-24.99 43.53-46.38 54.11-10.16 5.023-23.1 8.587-31.28 8.613-3.79 0.0118-4.555 0.333-8.217 3.446-6.958 5.916-20.59 13.71-28.3 16.17-1.722 0.551-4.011 1.599-5.087 2.328-1.076 0.7297-8.119 4.802-15.65 9.05-18.57 10.47-37.53 22.69-48.72 31.39-13.27 10.32-16.83 22.63-14.72 50.94 2.648 35.64 8.059 59.41 16.33 71.75l2.89 4.313 29.4 0.4963c34.14 0.5764 92.53 2.291 93.01 2.731 0.1793 0.166-74.3 0.2503-165.5 0.1877-91.21-0.0631-161.4-0.392-156-0.732zm130.9-101.8c-0.1092-1.007-3.147-5.947-6.75-10.98-7.889-11.01-19.71-28.99-22.37-34.01-1.594-3.014-2.402-3.727-4.695-4.139-7.259-1.304-17.91-5.324-27.58-10.41-1.809-0.9509 5.669 20.15 9.032 25.49 4.859 7.714 27.69 24.94 45.08 34 5.177 2.7 7.575 2.715 7.285 0.0442zm6.168-19.46c0.8235-0.9976 1.074-4.638 1.074-15.62 0-7.875-0.1764-14.5-0.3923-14.71-0.2158-0.2163-2.307 0.1044-4.647 0.7128-2.34 0.6082-7 1.335-10.35 1.616-7.067 0.5907-6.896 0-2.984 10.28 2.73 7.17 6.328 12.81 10.4 16.3 3.513 3.013 5.293 3.38 6.908 1.424zm49.91-15.13c3.913-2 11.37-9.412 15.96-15.85 3.982-5.592 8.688-15 8.214-16.42-0.1628-0.49-3.275-1.75-6.916-2.799-3.641-1.049-9.568-3.501-13.17-5.449l-6.551-3.541-2.173 2.087c-2.148 2.062-2.179 2.234-2.645 14.37-0.2592 6.754-0.6282 15.17-0.8198 18.7-0.3026 5.572-0.1405 6.682 1.232 8.43 1.896 2.415 2.946 2.489 6.867 0.484zm-118.1-5.725c-2.19-4.729-6.256-17.66-6.256-19.89 0-0.8683-1.901-1.089-9.391-1.089-5.165 0-9.391 0.2195-9.391 0.488 0 1.561 25.33 25.39 26.99 25.39 0.1762 0-0.7011-2.206-1.949-4.901zm149.8-9.536c5.487-3.687 19.46-14.65 19.07-14.96-0.126-0.1032-4.197-0.3888-9.046-0.6338l-8.816-0.4452-3.967 5.891c-4.284 6.363-7.088 11.99-6.473 12.98 0.9066 1.47 4.434 0.3864 9.228-2.836z",fill:"#13ad73"},null,-1),qe=e("path",{d:"m253.9 167.7c-0.2579 0.0513-1.238 0.5454-4.691 0.5216-3.625-0.0248 4.941 9.227 6.934 34.4-8.031-0.4678-8.408-3.285-24.81-5.999-15.88-2.627-25.28 5.883-29.57 18.88-3.429 10.39-3.592 23.66-1.19 36.39 2.348 12.45 7.148 24.39 13.74 32.65 6.909 8.654 14.05 10.96 20.49 10.82 8.459-0.1842 15.7-4.599 19.58-4.407 6.726 0.3331 13.29 8.894 28.17 2.151 6.047-2.741 12.03-7.819 17.08-14.81 4.984-6.907 9.051-15.68 11.35-25.91 2.018-8.972 2.678-19.07 1.41-30-1.616-13.93-7.519-20.42-14.9-23.01-8.286-2.905-18.43-0.8896-26.46 1.032-4.71 1.127-8.69 2.223-11.14 2.273-0.155 3e-3 -0.2829-4.1e-4 -0.4335 2e-3 -0.01-0.0695-0.0197-0.1385-0.0323-0.2078-2.249-11.58-4.704-29.29-5.401-33.64-0.152-0.9486 0.0845-1.177-0.1162-1.137z",fill:"#f2ac05","fill-rule":"evenodd"},null,-1),We=[He,qe];function Ke(a,t){return v(),y("svg",Xe,We)}var Ye=Q(Ue,[["render",Ke]]);const Ge={},Je={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Qe=e("path",{d:"m12 0c-6.624 0-12 5.376-12 12s5.376 12 12 12 12-5.376 12-12-5.376-12-12-12zm0 3.6c1.992 0 3.6 1.608 3.6 3.6s-1.608 3.6-3.6 3.6-3.6-1.608-3.6-3.6 1.608-3.6 3.6-3.6zm0 17.04c-3 0-5.652-1.536-7.2-3.864 0.036-2.388 4.8-3.696 7.2-3.696 2.388 0 7.164 1.308 7.2 3.696-1.548 2.328-4.2 3.864-7.2 3.864z"},null,-1),Ze=[Qe];function et(a,t){return v(),y("svg",Je,Ze)}var tt=Q(Ge,[["render",et]]);const nt={},lt={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},at=e("path",{d:"m12 0-2.115 2.115 8.37 8.385h-18.255v3h18.255l-8.37 8.385 2.115 2.115 12-12z"},null,-1),ot=[at];function st(a,t){return v(),y("svg",lt,ot)}var ge=Q(nt,[["render",st]]);const it=e("div",{id:"app-name"},[e("span",null,"Hey"),e("span",null,[V("Apple"),e("sup",null,"beta")])],-1),ut={id:"nav-main"},rt={id:"nav-user"},ct={href:"https://docs.heyapple.org",target:"_blank"},dt={setup(a){const{t}=G(),s=X("csrfToken");function r(u){u.preventDefault(),fetch("/auth/local",{method:"DELETE",headers:{"X-CSRF-Token":s}}).then(c=>{c.ok?window.location="/":window.dispatchEvent(new CustomEvent("error",{detail:{msg:t("signout.err"+c.status)}}))})}function o(u){u.stopPropagation(),document.querySelector("header nav").classList.toggle("open")}return document.addEventListener("click",function(){document.querySelector("header nav").classList.remove("open")}),(u,c)=>(v(),y("header",null,[p(Ye,{id:"logo"}),it,e("nav",null,[e("button",{onClick:o},[p(ge)]),e("ul",ut,[e("li",null,[p(n(oe),{to:"/"},{default:N(()=>[V(l(n(t)("nav.diary")),1)]),_:1})]),e("li",null,[p(n(oe),{to:"/food"},{default:N(()=>[V(l(n(t)("nav.food")),1)]),_:1})]),e("li",null,[p(n(oe),{to:"/recipes"},{default:N(()=>[V(l(n(t)("nav.recipes")),1)]),_:1})]),e("li",null,[p(n(oe),{to:"/shopping"},{default:N(()=>[V(l(n(t)("nav.shopping")),1)]),_:1})])]),e("ul",rt,[e("li",null,[p(n(oe),{to:"/profile"},{default:N(()=>[V(l(n(t)("nav.profile")),1)]),_:1})]),e("li",null,[p(n(oe),{to:"/settings"},{default:N(()=>[V(l(n(t)("nav.settings")),1)]),_:1})]),e("li",null,[e("a",ct,l(n(t)("nav.help")),1)]),e("li",null,[e("a",{href:"#",onClick:r},l(n(t)("nav.signout")),1)])])]),e("button",{onClick:o},[p(tt)])]))}},mt={},vt={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},ht=e("path",{d:"m7.6364 17.318-5.7273-5.7273-1.9091 1.9091 7.6364 7.6364 16.364-16.364-1.9091-1.9091z"},null,-1),ft=[ht];function _t(a,t){return v(),y("svg",vt,ft)}var ye=Q(mt,[["render",_t]]);const pt={},gt={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},bt=e("path",{d:"m12 1.6364-12 20.727h24zm0 4.353 8.2159 14.192h-16.43zm-1.0909 4.3743v5.4545h2.1818v-5.4545zm0 6.5455v2.1818h2.1818v-2.1818z"},null,-1),yt=[bt];function $t(a,t){return v(),y("svg",gt,yt)}var wt=Q(pt,[["render",$t]]);const kt={props:["msg"],emits:["timeout"],setup(a,{emit:t}){const s=a;return ve(()=>{setTimeout(function(){t("timeout",s.msg.id)},s.msg.time)}),(r,o)=>(v(),y("div",{class:B(["message",[a.msg.type,a.msg.id]])},[a.msg.type=="message"?(v(),K(ye,{key:0})):H("",!0),a.msg.type!="message"?(v(),K(wt,{key:1})):H("",!0),e("p",null,l(a.msg.msg),1)],2))}};const xt={id:"messages"},Ct={setup(a){const t=b([]);let s=0;function r(u){t.value.push({id:s++,type:u.type,msg:u.detail.msg,time:u.detail.timeout})}function o(u){t.value=t.value.filter(c=>c.id!=u)}return ve(()=>{window.addEventListener("message",r),window.addEventListener("warning",r),window.addEventListener("error",r)}),(u,c)=>(v(),y("div",xt,[(v(!0),y(J,null,te(t.value,i=>(v(),K(kt,{key:i.id,msg:i,onTimeout:o},null,8,["msg"]))),128))]))}};const Lt={setup(a){return ve(()=>{document.querySelector("body > .spinner-container").remove()}),(t,s)=>(v(),y(J,null,[p(dt),p(n(Re)),p(Ct)],64))}},Tt={},It={version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},St=e("path",{id:"path-top",d:"m0 3v2h24v-2z"},null,-1),Et=e("path",{id:"path-mid",d:"m0 13h24v-2h-24z"},null,-1),Mt=e("path",{id:"path-bottom",d:"m0 21h24v-2h-24z"},null,-1),Ft=[St,Et,Mt];function Dt(a,t){return v(),y("svg",It,Ft)}var zt=Q(Tt,[["render",Dt]]);const At={},Rt={width:"512",height:"512",version:"1.1",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},Ot=e("path",{d:"m251.2 4.007c-17.24-0.2277-34.69 4.924-50.29 15.67-14.33 9.866-26.9 26.43-33.11 43.62-1.357 3.754-2.073 4.828-2.992 4.475-10.97-4.217-29-5.131-40.42-2.049-23.57 6.359-41.5 24.22-48.52 48.31-2.553 8.761-3.407 21.84-1.997 30.6 0.5299 3.293 0.7902 6.162 0.5799 6.372-0.2104 0.2108-2.439 0.9186-4.956 1.572-16.5 4.283-34.28 18.21-43.89 34.41-8.382 14.11-11.91 27.14-11.93 44-0.02401 23.88 7.433 42.79 23.41 59.36 14.31 14.85 32.89 22.84 52.49 22.56 4.95-0.0689 10.41-0.4681 12.13-0.8863 2.9-0.7045 3.245-0.6061 4.695 1.334 8.833 11.82 16.82 18.58 29.19 24.7 6.707 3.32 9.412 5.257 16.09 11.53 24.85 23.35 47.68 40.8 76.05 58.12 9.503 5.8 18.01 13.61 20.54 18.86 3.313 6.878 3.637 11.06 1.825 23.56-2.778 19.18-7.936 38.33-13.13 48.74l-2.639 5.295h-13.49c-16.17-3e-3 -92.41 2.205-106.2 3.077l0.01-3e-3c-5.381 0.3399 64.84 0.6684 156 0.7315 91.2 0.0625 165.7-0.0216 165.5-0.1878-0.4753-0.4399-58.86-2.155-93-2.731l-29.4-0.4942-2.89-4.313c-8.274-12.35-13.68-36.12-16.33-71.76-2.105-28.31 1.454-40.62 14.72-50.94 11.18-8.699 30.14-20.92 48.72-31.39 7.533-4.248 14.57-8.318 15.65-9.048 1.076-0.7296 3.366-1.779 5.087-2.33 7.71-2.467 21.34-10.26 28.3-16.17 3.662-3.113 4.427-3.435 8.218-3.446 8.183-0.0267 21.12-3.59 31.28-8.613 21.39-10.58 38.52-30.56 46.38-54.11 10.84-32.47 5.42-66.98-14.68-93.52l-5.364-7.084 0.916-4.395c1.646-7.896 1.904-21.74 0.5502-29.5-5.632-32.29-26.9-56.92-56-64.86-4.726-1.29-8.51-1.647-18.49-1.74l-12.55-0.1186-5.101-3.647c-13.67-9.776-29.15-14.43-45.31-13.64-4.95 0.2432-11.26 0.9944-14.02 1.671l-5.028 1.229-5.539-5.72c-17.07-17.63-38.89-26.81-61.05-27.1zm2.728 163.7c0.2008-0.0398-0.0367 0.1881 0.1154 1.137 0.6972 4.35 3.151 22.06 5.4 33.64 0.0118 0.0694 0.0228 0.138 0.0328 0.2076 0.1506-2e-3 0.2799 9e-5 0.4349-3e-3 2.448-0.0501 6.427-1.143 11.14-2.27 8.028-1.922 18.18-3.94 26.46-1.035 7.379 2.587 13.28 9.078 14.9 23.01 1.268 10.94 0.6106 21.03-1.407 30-2.301 10.23-6.37 19.01-11.35 25.91-5.045 6.991-11.03 12.07-17.07 14.81-14.87 6.743-21.44-1.818-28.16-2.152-3.88-0.1922-11.12 4.224-19.58 4.409-6.437 0.1402-13.58-2.169-20.49-10.82-6.596-8.262-11.39-20.2-13.74-32.65-2.402-12.73-2.24-26 1.189-36.39 4.29-13 13.69-21.51 29.58-18.88 16.41 2.714 16.78 5.532 24.81 6-1.993-25.18-10.56-34.43-6.936-34.4 3.453 0.0238 4.434-0.4726 4.692-0.5239zm45.16 159.1 6.55 3.542c3.603 1.947 9.529 4.401 13.17 5.45 3.641 1.049 6.753 2.307 6.916 2.797 0.4733 1.423-4.232 10.83-8.214 16.42-4.588 6.442-12.05 13.85-15.96 15.86-3.919 2.004-4.971 1.93-6.867-0.4843-1.372-1.748-1.532-2.86-1.229-8.432 0.1916-3.529 0.558-11.94 0.8171-18.7 0.4657-12.13 0.4983-12.3 2.646-14.37zm35.38 12.77 8.817 0.4448c4.849 0.245 8.919 0.5294 9.045 0.6326 0.3835 0.315-13.58 11.27-19.07 14.96-4.795 3.222-8.322 4.307-9.229 2.837-0.6151-0.9971 2.187-6.619 6.471-12.98zm-166.7 4.596c7.489 0 9.391 0.219 9.391 1.087 0 2.234 4.067 15.16 6.257 19.89 1.248 2.694 2.123 4.9 1.947 4.9-1.66 0-26.99-23.83-26.99-25.39 0-0.2685 4.226-0.4876 9.391-0.4876zm16.13 1.727c0.0388-0.0118 0.0851-6e-3 0.1417 0.0231 9.674 5.087 20.32 9.107 27.58 10.41 2.293 0.4121 3.101 1.124 4.695 4.138 2.657 5.026 14.48 23 22.37 34.02 3.603 5.03 6.639 9.968 6.748 10.98 0.2897 2.671-2.108 2.658-7.285-0.0429-17.39-9.068-40.22-26.29-45.07-34.01-3.258-5.172-10.38-25.14-9.173-25.52zm67.9 9.71c0.263-9e-3 0.4337 9e-3 0.4876 0.0625 0.2159 0.2154 0.3921 6.837 0.3921 14.71 0 10.98-0.2506 14.62-1.074 15.62-1.615 1.956-3.397 1.59-6.909-1.423-4.068-3.49-7.665-9.13-10.4-16.3-3.912-10.28-4.082-9.686 2.985-10.28 3.355-0.2804 8.013-1.006 10.35-1.615 1.755-0.4562 3.373-0.7502 4.162-0.7776z"},null,-1),Pt=[Ot];function Nt(a,t){return v(),y("svg",Rt,Pt)}var Vt=Q(At,[["render",Nt]]);const jt={},Bt={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ut=e("path",{d:"m12 6c1.65 0 3-1.35 3-3s-1.35-3-3-3-3 1.35-3 3 1.35 3 3 3zm0 3c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3zm0 9c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3z"},null,-1),Xt=[Ut];function Ht(a,t){return v(),y("svg",Bt,Xt)}var Ee=Q(jt,[["render",Ht]]);const qt={id:"filter"},Wt=V(" This is the main search & filter area"),Kt={id:"main"},Yt={class:"controls"},Gt=e("span",{class:"spacer"},null,-1),Jt={class:"content"},Qt=V("This is the main area"),Zt={id:"details"},en={class:"controls"},tn=e("span",{class:"spacer"},null,-1),nn={class:"placeholder"},ue={emits:["detailVisibility"],setup(a,{expose:t,emit:s}){const{t:r}=G(),o=b(""),u=b("");function c(){o.value==""?(o.value="open-filter",u.value="",s("detailVisibility")):o.value=""}function i(){s("detailVisibility"),u.value==""?(u.value="open-details",o.value=""):u.value=""}function w(){s("detailVisibility"),u.value==""&&(u.value="open-details",o.value="")}return t({showDetails:w}),(m,h)=>(v(),y("main",{class:B([o.value,u.value])},[e("div",qt,[se(m.$slots,"filter",{},()=>[Wt])]),e("div",Kt,[e("div",Yt,[e("button",{onClick:c,class:"open-filter icon"},[p(zt)]),Gt,e("button",{onClick:i,class:"open-details icon"},[p(Ee)])]),e("div",Jt,[se(m.$slots,"main",{},()=>[Qt])])]),e("div",Zt,[e("div",en,[se(m.$slots,"head-details"),tn,e("button",{onClick:i,class:"open-details icon"},[p(ge)])]),se(m.$slots,"details",{},()=>[e("div",nn,[p(Vt),e("p",null,l(n(r)("details.noitem")),1)])])])],2))}},ln=["placeholder"],an=V("Additional filters"),Me={props:["data","placeholder"],emits:["result"],setup(a,{emit:t}){const s=a;var r=void 0;function o(c){c.preventDefault(),clearTimeout(r),r=setTimeout(function(){u(c.target.closest("form"))},500)}function u(c){let i=new FormData(c),w=s.data.filter(m=>{let h=m.size||1;for(let g of i.keys()){if(g=="name"){let d=i.get(g).toLowerCase();if(!m[g].toLowerCase().includes(d))return!1;continue}let[C,S]=i.getAll(g).map(d=>parseFloat(d));if(!isNaN(C)&&!isNaN(S)&&(m[g]/h<C||S<m[g]/h))return!1}return!0});t("result",w)}return(c,i)=>(v(),y("form",null,[e("input",{type:"text",name:"name",placeholder:a.placeholder,onInput:o},null,40,ln),se(c.$slots,"default",{confirm:o},()=>[an])]))}};const on={class:"slider"},sn=["name","value"],un=V(" \xA0\u2013\xA0 "),rn=["name","value"],cn={class:"bar"},dn={class:"slide"},mn=e("div",{class:"interact-area"},null,-1),vn=[mn],hn=e("div",{class:"interact-area"},null,-1),fn=[hn],Y={props:["label","name","unit","min","max","frac"],emits:["input"],setup(a,{emit:t}){const s=a,{t:r}=G(),o=b(parseFloat(s.min).toFixed(s.frac)),u=b(parseFloat(s.max).toFixed(s.frac)),c=b(0),i=b(100);we(()=>s.min,(_,f)=>w(_)),we(()=>s.max,(_,f)=>m(_));function w(_){let f=parseFloat(s.min)||0,k=parseFloat(_)||f;o.value=k,u.value=Math.max(o.value,u.value);let L=parseFloat(s.max)||0;c.value=(k-f)*100/(L-f),i.value=Math.max(c.value,i.value)}function m(_){let f=parseFloat(s.max)||0,k=parseFloat(_)||f;u.value=k,o.value=Math.min(o.value,u.value);let L=parseFloat(s.min)||0;i.value=(k-L)*100/(f-L),c.value=Math.min(c.value,i.value)}function h(_){_.target.blur(),w(_.target.value),t("input",_)}function g(_){_.target.blur(),m(_.target.value),t("input",_)}function C(_){let k=_.target.closest(".slide").getBoundingClientRect(),L=_.pageX!==void 0?_.pageX:_.changedTouches[0].pageX;L=Math.min(Math.max(L-k.left,0),k.width);let M=L*100/k.width,E=parseFloat(s.min)||0,R=parseFloat(s.max)||0,P=M/100*(R-E)+E;_.target.closest("button").classList.contains("min")?(o.value=P.toFixed(s.frac),u.value=Math.max(o.value,u.value),c.value=M,i.value=Math.max(c.value,i.value)):(u.value=P.toFixed(s.frac),o.value=Math.min(o.value,u.value),i.value=M,c.value=Math.min(c.value,i.value)),t("input",_)}function S(_){let f=_.target.closest("button");f.addEventListener("mousemove",C),f.addEventListener("touchmove",C),f.addEventListener("mouseup",d),f.addEventListener("touchend",d),f.addEventListener("mouseleave",d),f.addEventListener("touchcancel",d),f.classList.add("active")}function d(_){let f=_.target.closest("button");f.removeEventListener("mousemove",C),f.removeEventListener("touchmove",C),f.removeEventListener("mouseup",d),f.removeEventListener("touchend",d),f.removeEventListener("mouseleave",d),f.removeEventListener("touchcancel",d),f.classList.remove("active")}return(_,f)=>(v(),y("div",on,[e("label",null,[e("span",null,l(a.label)+" ("+l(n(r)("unit."+a.unit))+")",1),e("input",{type:"text",name:a.name,value:o.value,onChange:h},null,40,sn),un,e("input",{type:"text",name:a.name,value:u.value,onChange:g},null,40,rn)]),e("div",cn,[e("div",dn,[e("div",{class:"overlay",style:pe({left:c.value+"%",right:100-i.value+"%"})},null,4),e("button",{type:"button",class:"handle min",style:pe({left:c.value+"%"}),onMousedown:S,onTouchstart:S},vn,36),e("button",{type:"button",class:"handle max",style:pe({left:i.value+"%"}),onMousedown:S,onTouchstart:S},fn,36)])])]))}};const _n={class:"clickable-input"},pn=["placeholder"],gn=["value"],Fe={props:["label","placeholder"],emits:["confirm"],setup(a,{emit:t}){const s=b("");function r(o){o.preventDefault(),t("confirm",s.value),s.value=""}return(o,u)=>(v(),y("form",_n,[ie(e("input",{type:"text","onUpdate:modelValue":u[0]||(u[0]=c=>s.value=c),placeholder:a.placeholder},null,8,pn),[[xe,s.value]]),e("input",{type:"submit",onClick:r,value:a.label},null,8,gn)]))}};const bn={class:"clickable-select"},yn={value:"0",selected:""},$n=["value"],wn=["disabled"],kn={props:["label","placeholder","items","disabled"],emits:["confirm"],setup(a,{emit:t}){const s=a,{locale:r}=G(),o=b(0),u=new Intl.Collator(r.value,{numeric:!0}),c=W(()=>[...s.items].sort((w,m)=>u.compare(w.name,m.name)));function i(w){w.preventDefault(),o.value&&t("confirm",o.value)}return(w,m)=>(v(),y("form",bn,[ie(e("select",{"onUpdate:modelValue":m[0]||(m[0]=h=>o.value=h)},[e("option",yn,l(a.placeholder),1),(v(!0),y(J,null,te(n(c),h=>(v(),y("option",{key:h.id,value:h.id},l(h.name),9,$n))),128))],512),[[ke,o.value]]),e("button",{type:"submit",class:"async",onClick:i,disabled:a.disabled},l(a.label),9,wn)]))}};const xn={class:"clickable-date"},Cn=["value"],Ln=["value"],Tn=["disabled"],De={props:["label","date","time","disabled"],emits:["confirm"],setup(a,{emit:t}){function s(r){r.preventDefault();let o=new FormData(r.target.closest("form"));t("confirm",o.get("date"),o.get("time"))}return(r,o)=>(v(),y("form",xn,[e("input",{type:"date",name:"date",value:a.date},null,8,Cn),e("input",{type:"time",name:"time",value:a.time},null,8,Ln),e("button",{type:"submit",class:"async",onClick:s,disabled:a.disabled},l(a.label),9,Tn)]))}};const In={},Sn={class:"icon sort-arrow"};function En(a,t){return v(),y("span",Sn)}var de=Q(In,[["render",En]]);const Mn=["onClick"],Fn={class:"name"},Dn={class:"num"},zn={class:"unit"},An={class:"m num"},Rn={class:"unit"},On={class:"m num"},Pn={class:"unit"},Nn={class:"m num"},Vn={class:"unit"},ze={props:["items"],emits:"selected",setup(a,{emit:t}){const s=a,{t:r,locale:o}=G(),u=b("name"),c=b("asc"),i=new Intl.Collator(o.value,{numeric:!0}),w=W(()=>c.value=="asc"?[...s.items].sort((g,C)=>i.compare(g[u.value],C[u.value])):[...s.items].sort((g,C)=>-i.compare(g[u.value],C[u.value])));function m(g,C,S=1){return C?+parseFloat(g/C).toFixed(S):g}function h(g){let C=g.target.dataset.sort;u.value==C?c.value=c.value=="asc"?"desc":"asc":u.value=C}return(g,C)=>(v(),y("table",null,[e("thead",null,[e("tr",{class:B(c.value)},[e("th",{class:B(["name sort",{active:u.value=="name"}]),onClick:h,"data-sort":"name"},[V(l(n(r)("food.name"))+" ",1),p(de)],2),e("th",{class:B(["num sort",{active:u.value=="kcal"}]),onClick:h,"data-sort":"kcal"},[p(de),V(" "+l(n(r)("food.energy")),1)],2),e("th",{class:B(["m num sort",{active:u.value=="fat"}]),onClick:h,"data-sort":"fat"},[p(de),V(" "+l(n(r)("food.fat")),1)],2),e("th",{class:B(["m num sort",{active:u.value=="carb"}]),onClick:h,"data-sort":"carb"},[p(de),V(" "+l(n(r)("food.carbs2")),1)],2),e("th",{class:B(["m num sort",{active:u.value=="prot"}]),onClick:h,"data-sort":"prot"},[p(de),V(" "+l(n(r)("food.protein")),1)],2)],2)]),e("tbody",null,[(v(!0),y(J,null,te(n(w),S=>(v(),y("tr",{key:S.id,onClick:d=>g.$emit("selected",S.id)},[e("td",Fn,l(S.name),1),e("td",Dn,[V(l(m(S.kcal,S.size))+" ",1),e("span",zn,l(n(r)("unit.cal")),1)]),e("td",An,[V(l(m(S.fat,S.size))+" ",1),e("span",Rn,l(n(r)("unit.g")),1)]),e("td",On,[V(l(m(S.carb,S.size))+" ",1),e("span",Pn,l(n(r)("unit.g")),1)]),e("td",Nn,[V(l(m(S.prot,S.size))+" ",1),e("span",Vn,l(n(r)("unit.g")),1)])],8,Mn))),128))])]))}},jn={},Bn={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Un=e("path",{d:"m-7.5e-8 19.001v4.9993h4.9993l14.745-14.745-4.9993-4.9993zm23.61-13.611c0.51993-0.51993 0.51993-1.3598 0-1.8797l-3.1196-3.1196c-0.51993-0.51993-1.3598-0.51993-1.8797 0l-2.4397 2.4397 4.9993 4.9993z"},null,-1),Xn=[Un];function Hn(a,t){return v(),y("svg",Bn,Xn)}var Ce=Q(jn,[["render",Hn]]);const qn={key:0,class:"new-item"},Wn=e("hr",null,null,-1),Kn=e("section",{class:"subtitle"},"Some food category",-1),Yn={class:"tags"},Gn=e("span",{class:"tag"},"Tag 1",-1),Jn=e("span",{class:"tag"},"Tag 2",-1),Qn=e("span",{class:"tag"},"Tag 3",-1),Zn=["disabled"],el=e("hr",null,null,-1),tl={class:"tracking no-edit-mode"},nl={class:"tracking-amount"},ll={class:"unit"},al=e("label",null,"Add to recipe",-1),ol=e("label",null,"Add to diary",-1),sl=e("hr",null,null,-1),il={class:"nutrient-block"},ul=["disabled"],rl=["value"],cl={class:"unit"},dl=["value"],ml={class:"unit"},vl=["value"],hl={class:"unit"},fl=["value"],_l={class:"unit"},pl=["value"],gl={class:"unit"},bl=["disabled"],yl=["value"],$l={class:"unit"},wl=["value"],kl={class:"unit"},xl=["value"],Cl={class:"unit"},Ll=["value"],Tl={class:"unit"},Il=["value"],Sl={class:"unit"},El={setup(a){const{t}=G(),s=X("log"),r=X("csrfToken"),o=X("perms"),u=X("food"),c=X("recipes"),i=X("diary"),w=b([]),m=b(null),h=b(!1),g=b(!1),C=b(!1),S=b(!1),d=b(100),_=b(j.now().toISODate()),f=b(j.now().toLocaleString(j.TIME_24_SIMPLE)),k=b(null),L=b(null);function M(T){fetch("/api/v1/food",{method:"POST",headers:{"X-CSRF-Token":r}}).then(x=>{if(!x.ok)throw t("createfood.err"+x.status);return x.json()}).then(x=>{x.name=T,u.value.push(x),w.value.push(x),s.msg(t("createfood.ok")),I(x.id)}).catch(x=>s.err(x))}function E(){g.value=!0;let T=m.value.id;fetch("/api/v1/food/"+T,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams(new FormData(L.value))}).then(x=>{if(!x.ok)throw t("savefood.err"+x.status);return h.value=!1,fetch("/api/v1/food/"+T)}).then(x=>x.json()).then(x=>{x.name=t(x.id.toString()),u.value=u.value.map(A=>x.id==A.id?x:A),w.value=w.value.map(A=>x.id==A.id?x:A),m.value=m.value.id==x.id?x:m.value,s.msg(t("savefood.ok"))}).catch(x=>s.err(x)).finally(()=>{setTimeout(function(){g.value=!1},500)})}function R(T){C.value=!0,fetch(`/api/v1/recipe/${T}/ingredient/${m.value.id}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({amount:d.value})}).then(x=>{if(!x.ok)throw t("addfood.err"+x.status);return fetch("/api/v1/recipe/"+T)}).then(x=>x.json()).then(x=>{c.value=c.value.map(A=>x.id==A.id?x:A),d.value=100,s.msg(t("addfood.ok"))}).catch(x=>s.err(x)).finally(()=>{setTimeout(function(){C.value=!1},500)})}function P(T,x){S.value=!0,fetch(`/api/v1/diary/${T}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({id:m.value.id,amount:d.value,time:x,recipe:""})}).then(A=>{if(!A.ok)throw t("savediary.err"+A.status);return fetch("/api/v1/diary/"+T.replaceAll("-","/"))}).then(A=>A.json()).then(A=>{i.value[T]=A[0],d.value=100,s.msg(t("savediary.ok"))}).catch(A=>s.err(A)).finally(()=>{setTimeout(function(){S.value=!1},500)})}function q(T){w.value=T,m.value&&w.value.filter(x=>x.id==m.value.id).length==0&&(m.value=null)}function I(T){m.value=w.value.filter(x=>x.id==T)[0],_.value=j.now().toISODate(),f.value=j.now().toLocaleString(j.TIME_24_SIMPLE),d.value=100,k.value.showDetails()}function $(){h.value?E():h.value=!0}function D(T){T.target.blur(),isNaN(parseFloat(T.target.value))&&(T.target.value=m.value[T.target.name])}return(T,x)=>(v(),K(ue,{ref_key:"main",ref:k,onDetailVisibility:x[1]||(x[1]=A=>h.value=!1),class:B({"edit-mode":h.value})},Se({filter:N(()=>[n(o).canCreateFood?(v(),y("section",qn,[e("h2",null,l(n(t)("aria.headnew")),1),p(Fe,{label:n(t)("btn.new"),placeholder:n(t)("food.hintnew"),onConfirm:M},null,8,["label","placeholder"])])):H("",!0),Wn,e("section",null,[e("h2",null,l(n(t)("aria.headsearch")),1),p(Me,{data:n(u),placeholder:n(t)("food.hintsearch"),onResult:q},{default:N(A=>[e("fieldset",null,[e("legend",null,l(n(t)("aria.headmacro1")),1),p(Y,{label:n(t)("food.energy"),onInput:A.confirm,name:"kcal",unit:"cal",min:"0",max:"900",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.fat"),onInput:A.confirm,name:"fat",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.carbs"),onInput:A.confirm,name:"carb",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.protein"),onInput:A.confirm,name:"prot",unit:"g",min:"0",max:"89",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.fiber"),onInput:A.confirm,name:"fib",unit:"g",min:"0",max:"71",frac:"0"},null,8,["label","onInput"])]),e("fieldset",null,[e("legend",null,l(n(t)("aria.headmacro2")),1),p(Y,{label:n(t)("food.fatsat"),onInput:A.confirm,name:"fatsat",unit:"g",min:"0",max:"83",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.fato3"),onInput:A.confirm,name:"fato3",unit:"g",min:"0",max:"54",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.fato6"),onInput:A.confirm,name:"fato6",unit:"g",min:"0",max:"70",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.sugar"),onInput:A.confirm,name:"sug",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),p(Y,{label:n(t)("food.salt"),onInput:A.confirm,name:"salt",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"])])]),_:1},8,["data","placeholder"])])]),main:N(()=>[p(ze,{items:w.value,onSelected:I},null,8,["items"])]),_:2},[m.value?{name:"head-details",fn:N(()=>[e("h2",null,l(m.value.name),1)])}:void 0,m.value?{name:"details",fn:N(()=>[Kn,e("section",Yn,[Gn,Jn,Qn,n(o).canCreateFood||n(o).canEditFood?(v(),y("button",{key:0,class:"icon async",disabled:g.value,onClick:$},[h.value?H("",!0):(v(),K(Ce,{key:0})),h.value?(v(),K(ye,{key:1})):H("",!0)],8,Zn)):H("",!0)]),el,e("section",tl,[e("h2",null,l(n(t)("aria.headtrack")),1),e("fieldset",nl,[e("div",null,[e("label",null,l(n(t)("food.amount")),1),ie(e("input",{type:"number","onUpdate:modelValue":x[0]||(x[0]=A=>d.value=A),name:"amount"},null,512),[[xe,d.value]]),e("span",ll,l(n(t)("unit.g")),1)])]),e("fieldset",null,[al,p(kn,{label:n(t)("btn.add"),placeholder:n(t)("food.hintrec"),items:n(c),disabled:C.value,onConfirm:R},null,8,["label","placeholder","items","disabled"])]),e("fieldset",null,[ol,p(De,{label:n(t)("btn.add"),time:f.value,date:_.value,disabled:S.value,onConfirm:P},null,8,["label","time","date","disabled"])])]),sl,e("section",null,[e("h2",null,l(n(t)("aria.headnutrients")),1),e("form",{ref_key:"form",ref:L},[e("div",il,[e("fieldset",{disabled:!h.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("food.energy")),1),e("input",{type:"text",value:m.value.kcal,name:"kcal",onChange:D},null,40,rl),e("span",cl,l(n(t)("unit.cal")),1)]),e("div",null,[e("label",null,l(n(t)("food.fat")),1),e("input",{type:"text",value:m.value.fat,name:"fat",onChange:D},null,40,dl),e("span",ml,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.carbs2")),1),e("input",{type:"text",value:m.value.carb,name:"carb",onChange:D},null,40,vl),e("span",hl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.protein")),1),e("input",{type:"text",value:m.value.prot,name:"prot",onChange:D},null,40,fl),e("span",_l,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fiber")),1),e("input",{type:"text",value:m.value.fib,name:"fib",onChange:D},null,40,pl),e("span",gl,l(n(t)("unit.g")),1)])],8,ul),e("fieldset",{disabled:!h.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("food.fatsat")),1),e("input",{type:"text",value:m.value.fatsat,name:"fatsat",onChange:D},null,40,yl),e("span",$l,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fato3")),1),e("input",{type:"text",value:m.value.fato3,name:"fato3",onChange:D},null,40,wl),e("span",kl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fato6")),1),e("input",{type:"text",value:m.value.fato6,name:"fato6",onChange:D},null,40,xl),e("span",Cl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.sugar")),1),e("input",{type:"text",value:m.value.sug,name:"sug",onChange:D},null,40,Ll),e("span",Tl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.salt")),1),e("input",{type:"text",value:m.value.salt,name:"salt",onChange:D},null,40,Il),e("span",Sl,l(n(t)("unit.g")),1)])],8,bl)])],512)])])}:void 0]),1032,["class"]))}};const Ml=["disabled"],Fl=["value"],Dl={class:"unit"},zl=["value"],Al={props:["items","disabled"],setup(a,{expose:t}){const s=a,{t:r,locale:o}=G(),u=b("name"),c=b(null),i=new Intl.Collator(o.value,{numeric:!0}),w=W(()=>s.items.map(C=>({id:C.id,amount:C.amount,name:r(C.id.toString())})).sort((C,S)=>i.compare(C[u.value],S[u.value])));function m(g){g.target.blur();let C=parseFloat(g.target.value);(isNaN(C)||C<0)&&(g.target.value=0)}function h(){let g=new FormData(c.value),C=g.getAll("id"),S=g.getAll("amount"),d=[];return s.items.forEach(_=>{let f=parseInt(C.indexOf(_.id.toString())),k=parseFloat(S[f]);k!=_.amount&&d.push({id:_.id,amount:k})}),d}return t({getDiff:h}),(g,C)=>(v(),y("form",{class:"ingredients",ref_key:"form",ref:c},[e("fieldset",{disabled:a.disabled},[(v(!0),y(J,null,te(n(w),S=>(v(),y("div",{key:S.id},[e("label",null,l(S.name),1),e("input",{type:"number",name:"amount",value:S.amount,onChange:m},null,40,Fl),e("span",Dl,l(n(r)("unit.g")),1),e("input",{type:"hidden",name:"id",value:S.id},null,8,zl)]))),128))],8,Ml)],512))}},Rl={},Ol={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Pl=e("path",{d:"m0 18.316h2.5263v0.63158h-1.2632v1.2632h1.2632v0.63158h-2.5263v1.2632h3.7895v-5.0526h-3.7895zm1.2632-11.368h1.2632v-5.0526h-2.5263v1.2632h1.2632zm-1.2632 3.7895h2.2737l-2.2737 2.6526v1.1368h3.7895v-1.2632h-2.2737l2.2737-2.6526v-1.1368h-3.7895zm6.3158-7.5789v2.5263h17.684v-2.5263zm0 17.684h17.684v-2.5263h-17.684zm0-7.5789h17.684v-2.5263h-17.684z"},null,-1),Nl=[Pl];function Vl(a,t){return v(),y("svg",Ol,Nl)}var jl=Q(Rl,[["render",Vl]]);const Bl={class:"new-item"},Ul=e("hr",null,null,-1),Xl=["disabled"],Hl=["value"],ql=["innerHTML"],Wl={class:"tags"},Kl=e("span",{class:"tag no-edit-mode"},"Tag 1",-1),Yl=e("span",{class:"tag no-edit-mode"},"Tag 2",-1),Gl=e("span",{class:"tag no-edit-mode"},"Tag 3",-1),Jl=["disabled"],Ql=e("hr",null,null,-1),Zl={key:0,class:"tracking no-edit-mode"},ea={class:"tracking-amount"},ta={class:"unit"},na=e("label",null,"Add to diary",-1),la=e("hr",null,null,-1),aa=["innerHTML"],oa=e("hr",null,null,-1),sa={class:"no-edit-mode"},ia={class:"nutrient-block"},ua={class:"col50"},ra={class:"unit"},ca={class:"unit"},da={class:"col50"},ma={class:"unit"},va={class:"unit"},ha=e("hr",null,null,-1),fa={class:"prep"},_a=["disabled"],pa={class:"prep-size"},ga=["value"],ba=["disabled"],ya=["value"],$a={class:"unit"},wa=["value"],ka={class:"unit"},xa=["value"],Ca={class:"unit"},La=["value"],Ta={class:"unit"},Ia={class:"placeholder"},Sa={setup(a){const{t}=G(),s=X("log"),r=X("csrfToken");X("perms");const o=X("recipes"),u=X("diary"),c=b([]),i=b(null),w=b(!1),m=b(!1),h=b(!1),g=b(1),C=b("&nbsp;"),S=b(j.now().toISODate()),d=b(j.now().toLocaleString(j.TIME_24_SIMPLE)),_=b(null),f=b(null),k=b(null);function L(z,F=2){return+parseFloat(z/(i.value.size||1)).toFixed(F)}function M(z){return Math.min.apply(Math,o.value.map(F=>Math.floor(F[z]/F.size)))}function E(z){return Math.max.apply(Math,o.value.map(F=>Math.ceil(F[z]/F.size)))}function R(z){fetch("/api/v1/recipe",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({name:z})}).then(F=>{if(!F.ok)throw t("createrec.err"+F.status);return F.json()}).then(F=>{F.isowner=!0,o.value.push(F),c.value.push(F),s.msg(t("createrec.ok")),$(F.id)}).catch(F=>s.err(F))}function P(){m.value=!0;let z=i.value.id,F=i.value.owner,U=i.value.isowner;fetch("/api/v1/recipe/"+z,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams(new FormData(f.value))}).then(O=>{if(!O.ok)throw t("saverec.err"+O.status);return q(z)}).then(()=>fetch("/api/v1/recipe/"+z)).then(O=>O.json()).then(O=>{O.owner=F,O.isowner=U,o.value=o.value.map(ee=>O.id==ee.id?O:ee),c.value=c.value.map(ee=>O.id==ee.id?O:ee),i.value=i.value.id==O.id?O:i.value,s.msg(t("saverec.ok"))}).catch(O=>s.err(O)).finally(()=>{setTimeout(function(){m.value=!1},500)})}function q(z){let F=k.value.getDiff();return F.length==0?new Promise(U=>{w.value=!1,U()}):new Promise((U,O)=>{let ee=0,$e;F.forEach(Le=>{fetch(`/api/v1/recipe/${z}/ingredient/${Le.id}`,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({amount:Le.amount})}).then(_e=>{if(++ee,!_e.ok)throw t("saverec.err"+_e.status)}).catch(_e=>$e=_e).finally(()=>{ee==F.length&&($e?O($e):(w.value=!1,U()))})})})}function I(z,F){h.value=!0;let U=new URLSearchParams;i.value.items.forEach(O=>{U.append("id",O.id),U.append("amount",L(O.amount)*g.value),U.append("time",F),U.append("recipe",i.value.name)}),fetch(`/api/v1/diary/${z}`,{method:"POST",body:U,headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r}}).then(O=>{if(!O.ok)throw t("savediary.err"+O.status);return fetch("/api/v1/diary/"+z.replaceAll("-","/"))}).then(O=>O.json()).then(O=>{u.value[z]=O[0],g.value=1,s.msg(t("savediary.ok"))}).catch(O=>s.err(O)).finally(()=>{setTimeout(function(){h.value=!1},500)})}function $(z){i.value=c.value.filter(F=>F.id==z)[0],S.value=j.now().toISODate(),d.value=j.now().toLocaleString(j.TIME_24_SIMPLE),g.value=1,_.value.showDetails(),"isowner"in i.value?T():D()}function D(){fetch(`/api/v1/recipe/${i.value.id}/owner`).then(z=>{if(!z.ok)throw z;return z.json()}).then(z=>{i.value.isowner=z.isowner,i.value.owner=z.owner,T()}).catch(()=>{s.err(t("recowner.err")),C.value="&nbsp;"})}function T(){i.value.isowner?C.value=t("recipe.isowner"):i.value.owner?C.value=t("recipe.owner",{name:i.value.owner}):C.value=t("recipe.ispublic")}function x(z){c.value=z,i.value&&c.value.filter(F=>F.id==i.value.id).length==0&&(i.value=null)}function A(){w.value?P():w.value=!0}function fe(z){z.target.blur(),isNaN(parseFloat(z.target.value))&&(z.target.value=i.value[z.target.name])}return ve(()=>c.value=[...o.value]),(z,F)=>(v(),K(ue,{ref_key:"main",ref:_,onDetailVisibility:F[1]||(F[1]=U=>w.value=!1),class:B({"edit-mode":w.value})},Se({filter:N(()=>[e("section",Bl,[e("h2",null,l(n(t)("aria.headnewrec")),1),p(Fe,{label:n(t)("btn.new"),placeholder:n(t)("recipe.hintnew"),onConfirm:R},null,8,["label","placeholder"])]),Ul,e("section",null,[e("h2",null,l(n(t)("aria.headsearch")),1),p(Me,{data:n(o),placeholder:n(t)("recipe.hintsearch"),onResult:x},{default:N(U=>[e("fieldset",null,[p(Y,{label:n(t)("food.energy"),min:M("kcal"),max:E("kcal"),onInput:U.confirm,name:"kcal",unit:"cal",frac:"0"},null,8,["label","min","max","onInput"]),p(Y,{label:n(t)("food.fat"),min:M("fat"),max:E("fat"),onInput:U.confirm,name:"fat",unit:"g",frac:"0"},null,8,["label","min","max","onInput"]),p(Y,{label:n(t)("food.carbs"),min:M("carb"),max:E("carb"),onInput:U.confirm,name:"carb",unit:"g",frac:"0"},null,8,["label","min","max","onInput"]),p(Y,{label:n(t)("food.protein"),min:M("prot"),max:E("prot"),onInput:U.confirm,name:"prot",unit:"g",frac:"0"},null,8,["label","min","max","onInput"])])]),_:1},8,["data","placeholder"])])]),main:N(()=>[p(ze,{items:c.value,onSelected:$},null,8,["items"])]),_:2},[i.value?{name:"head-details",fn:N(()=>[e("form",{ref_key:"form",ref:f,autocomplete:"off",id:"form-recipe"},[e("fieldset",{disabled:!w.value},[e("input",{type:"text",name:"name",value:i.value.name},null,8,Hl)],8,Xl)],512)])}:void 0,i.value?{name:"details",fn:N(()=>[e("section",{class:"subtitle no-edit-mode",innerHTML:C.value},null,8,ql),e("section",Wl,[Kl,Yl,Gl,i.value.isowner?(v(),y("button",{key:0,class:"icon async",disabled:m.value,onClick:A},[w.value?H("",!0):(v(),K(Ce,{key:0})),w.value?(v(),K(ye,{key:1})):H("",!0)],8,Jl)):H("",!0)]),Ql,i.value.items.length?(v(),y("section",Zl,[e("h2",null,l(n(t)("aria.headtrack")),1),e("fieldset",ea,[e("div",null,[e("label",null,l(n(t)("food.amount")),1),ie(e("input",{type:"number","onUpdate:modelValue":F[0]||(F[0]=U=>g.value=U),name:"amount"},null,512),[[xe,g.value]]),e("span",ta,l(n(t)("recipe.size",g.value)),1)])]),e("fieldset",null,[na,p(De,{label:n(t)("btn.add"),time:d.value,date:S.value,disabled:h.value,onConfirm:I},null,8,["label","time","date","disabled"])])])):H("",!0),la,e("section",null,[e("h2",null,l(n(t)("aria.headingred")),1),i.value.items.length?H("",!0):(v(),y("p",{key:0,class:"msg-noitems",innerHTML:n(t)("recipe.noitems")},null,8,aa)),p(Al,{ref_key:"ingredients",ref:k,items:i.value.items,disabled:!w.value},null,8,["items","disabled"])]),oa,e("section",sa,[e("h2",null,l(n(t)("aria.headnutrients")),1),e("div",ia,[e("div",ua,[e("div",null,[e("label",null,l(n(t)("food.energy")),1),e("span",null,l(L(i.value.kcal,1)),1),e("span",ra,l(n(t)("unit.cal")),1)]),e("div",null,[e("label",null,l(n(t)("food.fat")),1),e("span",null,l(L(i.value.fat,1)),1),e("span",ca,l(n(t)("unit.g")),1)])]),e("div",da,[e("div",null,[e("label",null,l(n(t)("food.carbs2")),1),e("span",null,l(L(i.value.carb,1)),1),e("span",ma,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.protein")),1),e("span",null,l(L(i.value.prot,1)),1),e("span",va,l(n(t)("unit.g")),1)])])])]),ha,e("section",fa,[e("h2",null,l(n(t)("aria.headprep")),1),e("div",null,[e("fieldset",{disabled:!w.value,class:"col50"},[e("div",pa,[e("label",null,l(n(t)("recipe.size",2)),1),e("input",{type:"text",name:"size",form:"form-recipe",value:i.value.size,onChange:fe},null,40,ga),e("label",null,l(n(t)("recipe.size",i.value.size)),1)])],8,_a),e("fieldset",{disabled:!w.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("recipe.time")),1),e("input",{type:"text",disabled:"",value:i.value.preptime+i.value.cooktime+i.value.misctime},null,8,ya),e("span",$a,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.preptime")),1),e("input",{type:"text",name:"preptime",form:"form-recipe",value:i.value.preptime,onChange:fe},null,40,wa),e("span",ka,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.cooktime")),1),e("input",{type:"text",name:"cooktime",form:"form-recipe",value:i.value.cooktime,onChange:fe},null,40,xa),e("span",Ca,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.misctime")),1),e("input",{type:"text",name:"misctime",form:"form-recipe",value:i.value.misctime,onChange:fe},null,40,La),e("span",Ta,l(n(t)("unit.min")),1)])],8,ba)]),e("div",Ia,[p(jl),e("p",null,l(n(t)("todo.instructions")),1)])])])}:void 0]),1032,["class"]))}};const Ea=["disabled"],Ma={value:"1"},Fa={value:"2"},Da={value:"3"},za={value:"4"},Aa={value:"5"},Ra={value:"6"},Oa={value:"7"},Pa={value:"8"},Na={value:"9"},Va={value:"10"},ja={value:"11"},Ba={value:"12"},Ua=["value"],Xa=["disabled"],Ae={props:["mode","items"],emits:["selection"],setup(a,{emit:t}){const s=a,{t:r}=G(),o=b(j.now().month),u=b(j.now().year),c=b(null),i=W(()=>{let _=s.items.map(f=>parseInt(f.split("-")[0])).filter((f,k,L)=>L.indexOf(f)===k);return _.length==0&&(_=[j.now().year]),[Math.min(..._)-1,..._,Math.max(..._)+1]}),w=W(()=>u.value!=i.value[0]||o.value>1),m=W(()=>u.value!=i.value[i.value.length-1]||o.value<12);let h=[];we(()=>s.items,()=>{c.value.querySelectorAll("td>button").forEach(_=>{s.items.indexOf(_.dataset.date)!=-1?_.parentNode.classList.add("has-entries"):_.parentNode.classList.remove("has-entries")})});function g(){let _=j.now().toISODate(),f=j.local(u.value,o.value);f=f.minus({days:f.weekday}),!h.length&&s.mode!="toggle"&&(h=[_]),c.value.querySelectorAll("td").forEach(k=>{let L=f.toISODate();k.firstElementChild.textContent=f.day,k.firstElementChild.dataset.date=L,f.month!=o.value?k.classList.add("outside"):k.classList.remove("outside"),L==_?k.classList.add("today"):k.classList.remove("today"),s.items.indexOf(L)!=-1?k.classList.add("has-entries"):k.classList.remove("has-entries"),h.indexOf(L)!=-1?k.classList.add("active"):k.classList.remove("active"),f=f.plus({days:1})})}function C(){--o.value<1&&(o.value=12,--u.value),g()}function S(){++o.value>12&&(o.value=1,++u.value),g()}function d(_){let f=_.target.dataset.date;if(s.mode=="toggle"){let k=h.indexOf(f);k==-1?h.push(f):h.splice(k,1)}else h=[f];c.value.querySelectorAll("td>button").forEach(k=>{h.indexOf(k.dataset.date)!=-1?k.parentNode.classList.add("active"):k.parentNode.classList.remove("active")}),t("selection",h)}return ve(()=>{g(),t("selection",h)}),(_,f)=>(v(),y("div",{class:B(["calendar",[a.mode]])},[e("div",null,[e("button",{class:"prev icon",onClick:C,disabled:!n(w)},[p(ge)],8,Ea),e("div",null,[ie(e("select",{class:"month","onUpdate:modelValue":f[0]||(f[0]=k=>o.value=k),onChange:g},[e("option",Ma,l(n(r)("month.1")),1),e("option",Fa,l(n(r)("month.2")),1),e("option",Da,l(n(r)("month.3")),1),e("option",za,l(n(r)("month.4")),1),e("option",Aa,l(n(r)("month.5")),1),e("option",Ra,l(n(r)("month.6")),1),e("option",Oa,l(n(r)("month.7")),1),e("option",Pa,l(n(r)("month.8")),1),e("option",Na,l(n(r)("month.9")),1),e("option",Va,l(n(r)("month.10")),1),e("option",ja,l(n(r)("month.11")),1),e("option",Ba,l(n(r)("month.12")),1)],544),[[ke,o.value,void 0,{number:!0}]]),ie(e("select",{class:"year","onUpdate:modelValue":f[1]||(f[1]=k=>u.value=k),onChange:g},[(v(!0),y(J,null,te(n(i),k=>(v(),y("option",{value:k},l(k),9,Ua))),256))],544),[[ke,u.value,void 0,{number:!0}]])]),e("button",{class:"next icon",onClick:S,disabled:!n(m)},[p(ge)],8,Xa)]),e("table",{ref_key:"calendar",ref:c},[e("thead",null,[e("tr",null,[e("th",null,l(n(r)("day.cal7")),1),e("th",null,l(n(r)("day.cal1")),1),e("th",null,l(n(r)("day.cal2")),1),e("th",null,l(n(r)("day.cal3")),1),e("th",null,l(n(r)("day.cal4")),1),e("th",null,l(n(r)("day.cal5")),1),e("th",null,l(n(r)("day.cal6")),1)])]),e("tbody",null,[e("tr",null,[e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})])]),e("tr",null,[e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})])]),e("tr",null,[e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})])]),e("tr",null,[e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})])]),e("tr",null,[e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})])]),e("tr",null,[e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})]),e("td",null,[e("button",{onClick:d})])])])],512)],2))}};const Ha={class:"unit"},qa=["disabled"],Wa=["value"],Ka={class:"unit"},Ya=["value"],Ga=["value"],Ja=["value"],Qa=["value","disabled"],Za={class:"unit"},eo=["value"],to=["value"],no=["value"],lo={key:0},ao={key:1},oo={props:["entries","nutrient","disabled"],setup(a,{expose:t}){const s=a,{t:r}=G(),o=X("food"),u=X("prefs"),c=b("hour"),i=b("relative"),w=b(null),m=W(()=>{switch(c.value){case"hour":return g();case"day":return C();default:return[]}}),h=W(()=>{if(i.value=="relative")return"%";switch(s.nutrient){case"kcal":return" "+r("unit.cal");case"fat":case"carb":case"prot":return" "+r("unit.g");default:return" "+r("unit.mg")}});function g(){let L=[];if(s.entries){let M={};s.entries.forEach(E=>{let R=parseInt(E.time),P=j.fromObject({hours:R-R%2}),q=P.toFormat("t")+" - "+P.plus({hours:2}).toFormat("t");q in M||(M[q]={name:q,entries:[]});let I={id:E.food.id,name:r(E.food.id.toString()),amount:E.food.amount,nutrient:S(E.food),recipe:E.recipe,time:E.time,isrec:!1};if(E.recipe){let $=!1;M[q].entries.every(D=>D.isrec&&D.name==E.recipe?(D.entries.push(I),D.amount+=I.amount,D.nutrient+=I.nutrient,$=!0,!1):!0),$||M[q].entries.push({name:E.recipe,isrec:!0,amount:I.amount,nutrient:I.nutrient,entries:[I]})}else M[q].entries.push(I)}),L=Object.values(M),L.sort((E,R)=>E.name<R.name)}return L}function C(){return[{name:"Morning",entries:[{type:"recipe"},{type:"single"}]},{name:"Noon",entries:[{type:"recipe"},{type:"single"}]}]}function S(L){let E=o.value.filter(P=>P.id==L.id)[0][s.nutrient]*L.amount*.01;if(i.value=="metric")return Math.round(E);let R=u.value.rdi[s.nutrient];return Math.round(E*100/R)}function d(){i.value=="relative"?i.value="metric":i.value=="metric"&&(i.value="relative")}function _(L){L.target.closest("div").classList.toggle("open")}function f(L){L.target.blur();let M=parseFloat(L.target.value);(isNaN(M)||M<0)&&(L.target.value=0)}function k(){let L=new FormData(w.value),M=L.getAll("id"),E=L.getAll("amount"),R=L.getAll("recipe"),P=L.getAll("time"),q=[];return s.entries.forEach(I=>{for(let $=0;$<M.length;++$)if(M[$]==I.food.id&&R[$]==I.recipe&&P[$]==I.time){E[$]!=I.food.amount&&q.push({id:M[$],amount:E[$],recipe:R[$],time:P[$]});break}}),q}return t({getDiff:k}),(L,M)=>(v(),y("form",{class:"diary-entry-list",ref_key:"form",ref:w},[(v(!0),y(J,null,te(n(m),E=>(v(),y("fieldset",{key:E.name},[e("legend",null,l(E.name),1),(v(!0),y(J,null,te(E.entries,R=>(v(),y("div",{class:B({recipe:R.isrec})},[R.isrec?(v(),y(J,{key:0},[e("label",null,l(R.name),1),e("button",{class:"icon",type:"button",onClick:_},[p(Ee)]),e("span",null,l(R.amount),1),e("span",Ha,l(n(r)("unit.g")),1),e("span",{class:B(["nutrient",[a.nutrient,i.value]])},l(R.nutrient)+l(n(h)),3),e("fieldset",{disabled:a.disabled,style:pe({"--max-height":R.entries.length*41+"px"})},[(v(!0),y(J,null,te(R.entries,P=>(v(),y("div",{key:P.id},[e("label",null,l(P.name),1),e("input",{type:"number",name:"amount",value:P.amount,onChange:f},null,40,Wa),e("span",Ka,l(n(r)("unit.g")),1),e("span",{class:B(["nutrient",[a.nutrient,i.value]])},l(P.nutrient)+l(n(h)),3),e("input",{type:"hidden",name:"id",value:P.id},null,8,Ya),e("input",{type:"hidden",name:"recipe",value:P.recipe},null,8,Ga),e("input",{type:"hidden",name:"time",value:P.time},null,8,Ja)]))),128))],12,qa)],64)):(v(),y(J,{key:1},[e("label",null,l(R.name),1),e("input",{type:"number",name:"amount",value:R.amount,disabled:a.disabled,onChange:f},null,40,Qa),e("span",Za,l(n(r)("unit.g")),1),e("span",{class:B(["nutrient",[a.nutrient,i.value]])},l(R.nutrient)+l(n(h)),3),e("input",{type:"hidden",name:"id",value:R.id},null,8,eo),e("input",{type:"hidden",name:"recipe",value:R.recipe},null,8,to),e("input",{type:"hidden",name:"time",value:R.time},null,8,no)],64))],2))),256))]))),128)),e("button",{type:"button",class:"nutrient-mode-switch icon",onClick:d},[i.value=="relative"?(v(),y("span",lo,"%")):H("",!0),i.value=="metric"?(v(),y("span",ao,"g")):H("",!0)])],512))}};const so={class:"pie-chart"},io={viewBox:"0 0 256 256"},uo=["transform","stroke-dasharray"],ro=["stroke-dasharray","transform"],co=["stroke-dasharray","transform"],mo=e("hr",null,null,-1),me={props:["start","range","value","max","label","unit","frac"],setup(a){const t=a,s=112,r=W(()=>+(parseFloat(t.value)||0).toFixed(t.frac||0)),o=W(()=>+(parseFloat(t.max)||0).toFixed(t.frac||0)),u=W(()=>`rotate(${-90+(parseFloat(t.start)||0)} 128 128)`),c=W(()=>{let m=(parseFloat(t.range)||0)/360;return Math.PI*2*s*m+" 710"}),i=W(()=>{let m=(parseFloat(t.value)||0)/(parseFloat(t.max)||1),h=parseFloat(t.range)||0,g=Math.min(m,1)*h/360;return Math.PI*2*s*g+" 710"}),w=W(()=>{let m=(parseFloat(t.value)||0)/(parseFloat(t.max)||1),h=parseFloat(t.range)||0,g=Math.max(m-1,0)*h/360;return Math.PI*2*s*g+" 710"});return(m,h)=>(v(),y("figure",so,[(v(),y("svg",io,[e("circle",{class:"base",r:"112",cx:"128",cy:"128",transform:n(u),"stroke-dasharray":n(c)},null,8,uo),e("circle",{class:"good",r:"112",cx:"128",cy:"128","stroke-dasharray":n(i),transform:n(u)},null,8,ro),e("circle",{class:"bad",r:"112",cx:"128",cy:"128","stroke-dasharray":n(w),transform:n(u)},null,8,co)])),e("div",null,[se(m.$slots,"details",{},()=>[e("span",null,l(n(r))+" "+l(a.unit),1),mo,e("span",null,l(n(o))+" "+l(a.unit),1)])]),e("figcaption",null,l(a.label),1)]))}};const vo=e("hr",null,null,-1),ho=e("section",null,null,-1),fo={id:"charts-macro"},_o={class:"no-edit-mode"},po={class:"subtitle no-edit-mode"},go={class:"tabs"},bo=["disabled"],yo=e("hr",null,null,-1),$o={key:0},wo=["innerHTML"],ko={setup(a){const{t}=G(),s=X("log"),r=X("csrfToken"),o=X("diary"),u=X("prefs"),c=b(null),i=b(j.now()),w=b("kcal"),m=b(!1),h=b(!1),g=b(null),C=b(null),S=W(()=>Object.keys(o.value));let d=!1;function _(I){I.stopPropagation(),I.preventDefault(),k(I.target.closest("ul"),I.movementX),d=!0}function f(I){I.stopPropagation(),I.preventDefault();let $=Math.max(-16,Math.min(-I.deltaY,16));k(I.target.closest("ul"),$)}function k(I,$){let D=parseInt(I.style.getPropertyValue("--offset"))||0,T=Math.max(I.clientWidth-I.scrollWidth,Math.min(D+$,0));I.style.setProperty("--offset",T+"px")}function L(I){let $=I.target.closest("ul");$.addEventListener("pointermove",_),$.addEventListener("mouseup",M),$.addEventListener("touchend",M),$.addEventListener("mouseleave",M),$.addEventListener("touchcancel",M),d=!1}function M(I){let $=I.target.closest("ul");$.removeEventListener("pointermove",_),$.removeEventListener("mouseup",M),$.removeEventListener("touchend",M),$.removeEventListener("mouseleave",M),$.removeEventListener("touchcancel",M)}function E(I){d||(w.value=I.target.dataset.name)}function R(){c.value&&c.value.entries&&(h.value?P():h.value=!0)}function P(){let I=g.value.getDiff();if(I.length==0){h.value=!1;return}m.value=!0;let $=c.value.date,D=new URLSearchParams;I.forEach(T=>{D.append("id",T.id),D.append("amount",T.amount),D.append("time",T.time),D.append("recipe",T.recipe)}),fetch(`/api/v1/diary/${$}`,{method:"PUT",body:D,headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r}}).then(T=>{if(!T.ok)throw t("savediary.err"+T.status);return h.value=!1,fetch("/api/v1/diary/"+$.replaceAll("-","/"))}).then(T=>T.json()).then(T=>{T[0]&&T[0].kcal?o.value[$]=T[0]:delete o.value[$],q([$]),s.msg(t("savediary.ok"))}).catch(T=>s.err(T)).finally(()=>{setTimeout(function(){m.value=!1},500)})}function q(I){i.value=j.fromISO(I[0]);let $=i.value.toISODate();if(!o.value[$]){c.value={date:$};return}if(o.value[$].entries){c.value=o.value[$];return}fetch(`/api/v1/diary/${$.replaceAll("-","/")}/entries`).then(D=>D.json()).then(D=>{D.forEach(T=>T.time=T.date.split("T")[1].slice(0,5)),o.value[$].entries=D}).catch(D=>s.err(D)).finally(()=>c.value=o.value[$])}return(I,$)=>(v(),K(ue,{ref_key:"main",ref:C,class:B(["diary",{"edit-mode":h.value}]),onDetailVisibility:$[0]||($[0]=D=>h.value=!1)},{filter:N(()=>[e("section",null,[e("h2",null,l(n(t)("aria.headcal")),1),p(Ae,{items:n(S),onSelection:q},null,8,["items"])]),vo,ho]),main:N(()=>[e("section",null,[p(me)]),e("section",fo,[p(me,{class:"kcal",start:"225",range:"270",frac:"0",label:n(t)("food.energy"),unit:n(t)("unit.cal"),value:c.value?c.value.kcal:0,max:n(u).rdi.kcal},null,8,["label","unit","value","max"]),p(me,{class:"fat",start:"225",range:"270",frac:"0",label:n(t)("food.fat"),unit:n(t)("unit.g"),value:c.value?c.value.fat:0,max:n(u).rdi.fat},null,8,["label","unit","value","max"]),p(me,{class:"carb",start:"225",range:"270",frac:"0",label:n(t)("food.carbs2"),unit:n(t)("unit.g"),value:c.value?c.value.carb:0,max:n(u).rdi.carb},null,8,["label","unit","value","max"]),p(me,{class:"prot",start:"225",range:"270",frac:"0",label:n(t)("food.protein"),unit:n(t)("unit.g"),value:c.value?c.value.prot:0,max:n(u).rdi.prot},null,8,["label","unit","value","max"])])]),"head-details":N(()=>[e("h2",_o,l(i.value.weekdayLong),1)]),details:N(()=>[e("section",po,l(i.value.toLocaleString(n(j).DATE_FULL)),1),e("section",go,[e("div",null,[e("ul",{onMousedown:L,onTouchstart:L,onWheel:f},[e("li",{class:B({active:w.value=="kcal"})},[e("button",{"data-name":"kcal",onClick:E},l(n(t)("food.energy")),1)],2),e("li",{class:B({active:w.value=="fat"})},[e("button",{"data-name":"fat",onClick:E},l(n(t)("food.fat")),1)],2),e("li",{class:B({active:w.value=="carb"})},[e("button",{"data-name":"carb",onClick:E},l(n(t)("food.carbs2")),1)],2),e("li",{class:B({active:w.value=="prot"})},[e("button",{"data-name":"prot",onClick:E},l(n(t)("food.protein")),1)],2)],32)]),e("button",{class:"icon async",disabled:m.value,onClick:R},[h.value?H("",!0):(v(),K(Ce,{key:0})),h.value?(v(),K(ye,{key:1})):H("",!0)],8,bo)]),yo,c.value?(v(),y("section",$o,[e("h2",null,l(n(t)("aria.headlog")),1),c.value.entries?H("",!0):(v(),y("p",{key:0,class:"msg-noitems",innerHTML:n(t)("diary.noitems")},null,8,wo)),c.value.entries?(v(),K(oo,{key:1,ref_key:"entries",ref:g,entries:c.value.entries,nutrient:w.value,disabled:!h.value},null,8,["entries","nutrient","disabled"])):H("",!0)])):H("",!0)]),_:1},8,["class"]))}},xo=e("hr",null,null,-1),Co=e("section",null,null,-1),Lo=V(" Shopping Lists "),To={setup(a){const{t}=G(),s=X("diary"),r=b(null),o=W(()=>Object.keys(s.value));function u(c){console.log(c)}return(c,i)=>(v(),K(ue,{ref_key:"main",ref:r},{filter:N(()=>[e("section",null,[e("h2",null,l(n(t)("aria.headcal")),1),p(Ae,{mode:"toggle",items:n(o),onSelection:u},null,8,["items"])]),xo,Co]),main:N(()=>[Lo]),_:1},512))}},Io=V(" Profile "),So={setup(a){return(t,s)=>(v(),K(ue,null,{main:N(()=>[Io]),_:1}))}},Eo=V(" Settings "),Mo={setup(a){return(t,s)=>(v(),K(ue,null,{main:N(()=>[Eo]),_:1}))}},Fo=Oe({history:Pe(),routes:[{path:"/",name:"diary",component:ko},{path:"/recipes",name:"recipes",component:Sa},{path:"/food",name:"food",component:El},{path:"/shopping",name:"shopping",component:To},{path:"/profile",name:"profile",component:So},{path:"/settings",name:"settings",component:Mo}]});let be=document.documentElement.lang||navigator.language;!be&&navigator.languages!=null&&(be=navigator.languages[0]);Ne.defaultLocale=be;const Te=document.querySelector("meta[name='_csrf']"),Do=Te?Te.content:"",zo=function(){const a=document.documentElement.dataset.perm||1,t=65536,s=131072;function r(o){return(a&o)==o}return{canCreateFood:r(t),canEditFood:r(s)}}(),Ao=function(){function a(t){return typeof t=="string"?t:"message"in t?t.message:ne.global.t("err.err")}return{msg:function(t){let s={msg:a(t),timeout:3e3};window.dispatchEvent(new CustomEvent("message",{detail:s}))},warn:function(t){let s={msg:a(t),timeout:4e3};window.dispatchEvent(new CustomEvent("warning",{detail:s}))},err:function(t){let s={msg:a(t),timeout:5e3};window.dispatchEvent(new CustomEvent("error",{detail:s}))}}}(),Z=Ve(Lt);let ne,le,re,ae,ce;function Ro(a){ne=je({legacy:!1,locale:be.split("-")[0],fallbackLocale:"en",messages:a}),le&&re&&ae&&ce&&he()}function Oo(a){le=a,ne&&re&&ae&&ce&&he()}function Po(a){re=a,ne&&le&&ae&&ce&&he()}function No(a){ae={},a.forEach(t=>ae[t.date]=t),ne&&le&&re&&ce&&he()}function Ie(a){ce=a,ne&&le&&re&&ae&&he()}function he(){le.forEach(a=>{a.name=ne.global.t(a.id.toString())}),Z.provide("csrfToken",Do),Z.provide("perms",zo),Z.provide("food",b(le)),Z.provide("recipes",b(re)),Z.provide("diary",b(ae)),Z.provide("prefs",b(ce)),Z.provide("log",Ao),Z.use(Fo),Z.use(ne),Z.mount("#app")}fetch("/app/l10n.json").then(a=>a.json()).then(Ro);fetch("/api/v1/foods").then(a=>a.json()).then(Oo);fetch("/api/v1/recipes").then(a=>a.json()).then(Po);fetch("/api/v1/diary").then(a=>a.json()).then(No);fetch("/api/v1/prefs").then(a=>a.json()).then(Ie).catch(()=>{Ie({rdi:{kcal:2e3,fat:60,carb:270,prot:80}})});
