import{o as v,c as w,a as e,u as X,i as U,b as g,w as z,d as D,t as l,e as n,R as ee,f as ie,g as B,h as V,n as P,r as y,F as W,j as Q,k as Fe,l as se,m as ke,p as ge,q as te,v as ye,s as G,x as be,D as A,y as Ce,z as ze,A as De,S as Re,B as Oe,C as Ae}from"./vendor.js";const Ne=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&c(a)}).observe(document,{childList:!0,subtree:!0});function u(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(o){if(o.ep)return;o.ep=!0;const s=u(o);fetch(o.href,s)}};Ne();var K=(i,t)=>{const u=i.__vccOpts||i;for(const[c,o]of t)u[c]=o;return u};const Pe={},Ve={width:"512",height:"512",version:"1.1",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},Be=e("path",{d:"m114.6 507.3c13.82-0.8729 90.06-3.083 106.2-3.079h13.49l2.639-5.293c5.191-10.41 10.35-29.57 13.13-48.74 1.811-12.5 1.488-16.68-1.826-23.56-2.528-5.249-11.04-13.06-20.54-18.86-28.38-17.32-51.21-34.77-76.05-58.12-6.673-6.272-9.377-8.209-16.08-11.53-12.37-6.124-20.36-12.88-29.19-24.7-1.45-1.941-1.795-2.038-4.695-1.334-1.722 0.4182-7.18 0.8166-12.13 0.8854-19.6 0.2722-38.18-7.715-52.49-22.56-15.97-16.57-23.43-35.49-23.41-59.37 0.01786-16.86 3.547-29.88 11.93-44 9.617-16.19 27.39-30.13 43.89-34.41 2.517-0.653 4.748-1.36 4.958-1.571 0.2103-0.2107-0.05169-3.078-0.5816-6.371-1.41-8.759-0.556-21.84 1.997-30.61 7.023-24.1 24.96-41.95 48.52-48.31 11.42-3.082 29.45-2.167 40.42 2.049 0.919 0.3533 1.637-0.7202 2.994-4.474 6.21-17.18 18.79-33.75 33.11-43.62 35.65-24.56 80.99-19.9 111.3 11.44l5.539 5.719 5.025-1.229c2.764-0.6762 9.075-1.428 14.02-1.672 16.17-0.7944 31.64 3.865 45.31 13.64l5.1 3.647 12.55 0.1171c9.984 0.09312 13.77 0.4491 18.49 1.739 29.1 7.945 50.37 32.58 56 64.86 1.354 7.764 1.096 21.6-0.5502 29.5l-0.916 4.394 5.367 7.086c20.1 26.54 25.52 61.05 14.68 93.52-7.862 23.55-24.99 43.53-46.38 54.11-10.16 5.023-23.1 8.587-31.28 8.613-3.79 0.0118-4.555 0.333-8.217 3.446-6.958 5.916-20.59 13.71-28.3 16.17-1.722 0.551-4.011 1.599-5.087 2.328-1.076 0.7297-8.119 4.802-15.65 9.05-18.57 10.47-37.53 22.69-48.72 31.39-13.27 10.32-16.83 22.63-14.72 50.94 2.648 35.64 8.059 59.41 16.33 71.75l2.89 4.313 29.4 0.4963c34.14 0.5764 92.53 2.291 93.01 2.731 0.1793 0.166-74.3 0.2503-165.5 0.1877-91.21-0.0631-161.4-0.392-156-0.732zm130.9-101.8c-0.1092-1.007-3.147-5.947-6.75-10.98-7.889-11.01-19.71-28.99-22.37-34.01-1.594-3.014-2.402-3.727-4.695-4.139-7.259-1.304-17.91-5.324-27.58-10.41-1.809-0.9509 5.669 20.15 9.032 25.49 4.859 7.714 27.69 24.94 45.08 34 5.177 2.7 7.575 2.715 7.285 0.0442zm6.168-19.46c0.8235-0.9976 1.074-4.638 1.074-15.62 0-7.875-0.1764-14.5-0.3923-14.71-0.2158-0.2163-2.307 0.1044-4.647 0.7128-2.34 0.6082-7 1.335-10.35 1.616-7.067 0.5907-6.896 0-2.984 10.28 2.73 7.17 6.328 12.81 10.4 16.3 3.513 3.013 5.293 3.38 6.908 1.424zm49.91-15.13c3.913-2 11.37-9.412 15.96-15.85 3.982-5.592 8.688-15 8.214-16.42-0.1628-0.49-3.275-1.75-6.916-2.799-3.641-1.049-9.568-3.501-13.17-5.449l-6.551-3.541-2.173 2.087c-2.148 2.062-2.179 2.234-2.645 14.37-0.2592 6.754-0.6282 15.17-0.8198 18.7-0.3026 5.572-0.1405 6.682 1.232 8.43 1.896 2.415 2.946 2.489 6.867 0.484zm-118.1-5.725c-2.19-4.729-6.256-17.66-6.256-19.89 0-0.8683-1.901-1.089-9.391-1.089-5.165 0-9.391 0.2195-9.391 0.488 0 1.561 25.33 25.39 26.99 25.39 0.1762 0-0.7011-2.206-1.949-4.901zm149.8-9.536c5.487-3.687 19.46-14.65 19.07-14.96-0.126-0.1032-4.197-0.3888-9.046-0.6338l-8.816-0.4452-3.967 5.891c-4.284 6.363-7.088 11.99-6.473 12.98 0.9066 1.47 4.434 0.3864 9.228-2.836z",fill:"#13ad73"},null,-1),je=e("path",{d:"m253.9 167.7c-0.2579 0.0513-1.238 0.5454-4.691 0.5216-3.625-0.0248 4.941 9.227 6.934 34.4-8.031-0.4678-8.408-3.285-24.81-5.999-15.88-2.627-25.28 5.883-29.57 18.88-3.429 10.39-3.592 23.66-1.19 36.39 2.348 12.45 7.148 24.39 13.74 32.65 6.909 8.654 14.05 10.96 20.49 10.82 8.459-0.1842 15.7-4.599 19.58-4.407 6.726 0.3331 13.29 8.894 28.17 2.151 6.047-2.741 12.03-7.819 17.08-14.81 4.984-6.907 9.051-15.68 11.35-25.91 2.018-8.972 2.678-19.07 1.41-30-1.616-13.93-7.519-20.42-14.9-23.01-8.286-2.905-18.43-0.8896-26.46 1.032-4.71 1.127-8.69 2.223-11.14 2.273-0.155 3e-3 -0.2829-4.1e-4 -0.4335 2e-3 -0.01-0.0695-0.0197-0.1385-0.0323-0.2078-2.249-11.58-4.704-29.29-5.401-33.64-0.152-0.9486 0.0845-1.177-0.1162-1.137z",fill:"#f2ac05","fill-rule":"evenodd"},null,-1),Ue=[Be,je];function He(i,t){return v(),w("svg",Ve,Ue)}var Xe=K(Pe,[["render",He]]);const qe={},We={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ke=e("path",{d:"m12 0c-6.624 0-12 5.376-12 12s5.376 12 12 12 12-5.376 12-12-5.376-12-12-12zm0 3.6c1.992 0 3.6 1.608 3.6 3.6s-1.608 3.6-3.6 3.6-3.6-1.608-3.6-3.6 1.608-3.6 3.6-3.6zm0 17.04c-3 0-5.652-1.536-7.2-3.864 0.036-2.388 4.8-3.696 7.2-3.696 2.388 0 7.164 1.308 7.2 3.696-1.548 2.328-4.2 3.864-7.2 3.864z"},null,-1),Ye=[Ke];function Ge(i,t){return v(),w("svg",We,Ye)}var Je=K(qe,[["render",Ge]]);const Qe={},Ze={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},et=e("path",{d:"m12 0-2.115 2.115 8.37 8.385h-18.255v3h18.255l-8.37 8.385 2.115 2.115 12-12z"},null,-1),tt=[et];function nt(i,t){return v(),w("svg",Ze,tt)}var ve=K(Qe,[["render",nt]]);const lt=e("div",{id:"app-name"},[e("span",null,"Hey"),e("span",null,"Apple")],-1),at={id:"nav-main"},ot={id:"nav-user"},st={href:"https://docs.heyapple.org",target:"_blank"},it={setup(i){const{t}=X(),u=U("csrfToken");function c(s){s.preventDefault(),fetch("/auth/local",{method:"DELETE",headers:{"X-CSRF-Token":u}}).then(a=>{a.ok?window.location="/":window.dispatchEvent(new CustomEvent("error",{detail:{msg:t("signout.err"+a.status)}}))})}function o(s){s.stopPropagation(),document.querySelector("header nav").classList.toggle("open")}return document.addEventListener("click",function(){document.querySelector("header nav").classList.remove("open")}),(s,a)=>(v(),w("header",null,[g(Xe,{id:"logo"}),lt,e("nav",null,[e("button",{onClick:o},[g(ve)]),e("ul",at,[e("li",null,[g(n(ee),{to:"/"},{default:z(()=>[D(l(n(t)("nav.diary")),1)]),_:1})]),e("li",null,[g(n(ee),{to:"/food"},{default:z(()=>[D(l(n(t)("nav.food")),1)]),_:1})]),e("li",null,[g(n(ee),{to:"/recipes"},{default:z(()=>[D(l(n(t)("nav.recipes")),1)]),_:1})]),e("li",null,[g(n(ee),{to:"/shopping"},{default:z(()=>[D(l(n(t)("nav.shopping")),1)]),_:1})])]),e("ul",ot,[e("li",null,[g(n(ee),{to:"/profile"},{default:z(()=>[D(l(n(t)("nav.profile")),1)]),_:1})]),e("li",null,[g(n(ee),{to:"/settings"},{default:z(()=>[D(l(n(t)("nav.settings")),1)]),_:1})]),e("li",null,[e("a",st,l(n(t)("nav.help")),1)]),e("li",null,[e("a",{href:"#",onClick:c},l(n(t)("nav.signout")),1)])])]),e("button",{onClick:o},[g(Je)])]))}},ut={},ct={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},rt=e("path",{d:"m7.6364 17.318-5.7273-5.7273-1.9091 1.9091 7.6364 7.6364 16.364-16.364-1.9091-1.9091z"},null,-1),dt=[rt];function mt(i,t){return v(),w("svg",ct,dt)}var _e=K(ut,[["render",mt]]);const vt={},ht={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},_t=e("path",{d:"m12 1.6364-12 20.727h24zm0 4.353 8.2159 14.192h-16.43zm-1.0909 4.3743v5.4545h2.1818v-5.4545zm0 6.5455v2.1818h2.1818v-2.1818z"},null,-1),ft=[_t];function pt(i,t){return v(),w("svg",ht,ft)}var gt=K(vt,[["render",pt]]);const bt={props:["msg"],emits:["timeout"],setup(i,{emit:t}){const u=i;return ie(()=>{setTimeout(function(){t("timeout",u.msg.id)},u.msg.time)}),(c,o)=>(v(),w("div",{class:P(["message",[i.msg.type,i.msg.id]])},[i.msg.type=="message"?(v(),B(_e,{key:0})):V("",!0),i.msg.type!="message"?(v(),B(gt,{key:1})):V("",!0),e("p",null,l(i.msg.msg),1)],2))}};const yt={id:"messages"},$t={setup(i){const t=y([]);let u=0;function c(s){t.value.push({id:u++,type:s.type,msg:s.detail.msg,time:s.detail.timeout})}function o(s){t.value=t.value.filter(a=>a.id!=s)}return ie(()=>{window.addEventListener("message",c),window.addEventListener("warning",c),window.addEventListener("error",c)}),(s,a)=>(v(),w("div",yt,[(v(!0),w(W,null,Q(t.value,_=>(v(),B(bt,{key:_.id,msg:_,onTimeout:o},null,8,["msg"]))),128))]))}};const wt={setup(i){return ie(()=>{document.querySelector("body > .spinner-container").remove()}),(t,u)=>(v(),w(W,null,[g(it),g(n(Fe)),g($t)],64))}},kt={},xt={version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ct=e("path",{id:"path-top",d:"m0 3v2h24v-2z"},null,-1),Lt=e("path",{id:"path-mid",d:"m0 13h24v-2h-24z"},null,-1),It=e("path",{id:"path-bottom",d:"m0 21h24v-2h-24z"},null,-1),St=[Ct,Lt,It];function Tt(i,t){return v(),w("svg",xt,St)}var Et=K(kt,[["render",Tt]]);const Mt={},Ft={width:"512",height:"512",version:"1.1",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},zt=e("path",{d:"m251.2 4.007c-17.24-0.2277-34.69 4.924-50.29 15.67-14.33 9.866-26.9 26.43-33.11 43.62-1.357 3.754-2.073 4.828-2.992 4.475-10.97-4.217-29-5.131-40.42-2.049-23.57 6.359-41.5 24.22-48.52 48.31-2.553 8.761-3.407 21.84-1.997 30.6 0.5299 3.293 0.7902 6.162 0.5799 6.372-0.2104 0.2108-2.439 0.9186-4.956 1.572-16.5 4.283-34.28 18.21-43.89 34.41-8.382 14.11-11.91 27.14-11.93 44-0.02401 23.88 7.433 42.79 23.41 59.36 14.31 14.85 32.89 22.84 52.49 22.56 4.95-0.0689 10.41-0.4681 12.13-0.8863 2.9-0.7045 3.245-0.6061 4.695 1.334 8.833 11.82 16.82 18.58 29.19 24.7 6.707 3.32 9.412 5.257 16.09 11.53 24.85 23.35 47.68 40.8 76.05 58.12 9.503 5.8 18.01 13.61 20.54 18.86 3.313 6.878 3.637 11.06 1.825 23.56-2.778 19.18-7.936 38.33-13.13 48.74l-2.639 5.295h-13.49c-16.17-3e-3 -92.41 2.205-106.2 3.077l0.01-3e-3c-5.381 0.3399 64.84 0.6684 156 0.7315 91.2 0.0625 165.7-0.0216 165.5-0.1878-0.4753-0.4399-58.86-2.155-93-2.731l-29.4-0.4942-2.89-4.313c-8.274-12.35-13.68-36.12-16.33-71.76-2.105-28.31 1.454-40.62 14.72-50.94 11.18-8.699 30.14-20.92 48.72-31.39 7.533-4.248 14.57-8.318 15.65-9.048 1.076-0.7296 3.366-1.779 5.087-2.33 7.71-2.467 21.34-10.26 28.3-16.17 3.662-3.113 4.427-3.435 8.218-3.446 8.183-0.0267 21.12-3.59 31.28-8.613 21.39-10.58 38.52-30.56 46.38-54.11 10.84-32.47 5.42-66.98-14.68-93.52l-5.364-7.084 0.916-4.395c1.646-7.896 1.904-21.74 0.5502-29.5-5.632-32.29-26.9-56.92-56-64.86-4.726-1.29-8.51-1.647-18.49-1.74l-12.55-0.1186-5.101-3.647c-13.67-9.776-29.15-14.43-45.31-13.64-4.95 0.2432-11.26 0.9944-14.02 1.671l-5.028 1.229-5.539-5.72c-17.07-17.63-38.89-26.81-61.05-27.1zm2.728 163.7c0.2008-0.0398-0.0367 0.1881 0.1154 1.137 0.6972 4.35 3.151 22.06 5.4 33.64 0.0118 0.0694 0.0228 0.138 0.0328 0.2076 0.1506-2e-3 0.2799 9e-5 0.4349-3e-3 2.448-0.0501 6.427-1.143 11.14-2.27 8.028-1.922 18.18-3.94 26.46-1.035 7.379 2.587 13.28 9.078 14.9 23.01 1.268 10.94 0.6106 21.03-1.407 30-2.301 10.23-6.37 19.01-11.35 25.91-5.045 6.991-11.03 12.07-17.07 14.81-14.87 6.743-21.44-1.818-28.16-2.152-3.88-0.1922-11.12 4.224-19.58 4.409-6.437 0.1402-13.58-2.169-20.49-10.82-6.596-8.262-11.39-20.2-13.74-32.65-2.402-12.73-2.24-26 1.189-36.39 4.29-13 13.69-21.51 29.58-18.88 16.41 2.714 16.78 5.532 24.81 6-1.993-25.18-10.56-34.43-6.936-34.4 3.453 0.0238 4.434-0.4726 4.692-0.5239zm45.16 159.1 6.55 3.542c3.603 1.947 9.529 4.401 13.17 5.45 3.641 1.049 6.753 2.307 6.916 2.797 0.4733 1.423-4.232 10.83-8.214 16.42-4.588 6.442-12.05 13.85-15.96 15.86-3.919 2.004-4.971 1.93-6.867-0.4843-1.372-1.748-1.532-2.86-1.229-8.432 0.1916-3.529 0.558-11.94 0.8171-18.7 0.4657-12.13 0.4983-12.3 2.646-14.37zm35.38 12.77 8.817 0.4448c4.849 0.245 8.919 0.5294 9.045 0.6326 0.3835 0.315-13.58 11.27-19.07 14.96-4.795 3.222-8.322 4.307-9.229 2.837-0.6151-0.9971 2.187-6.619 6.471-12.98zm-166.7 4.596c7.489 0 9.391 0.219 9.391 1.087 0 2.234 4.067 15.16 6.257 19.89 1.248 2.694 2.123 4.9 1.947 4.9-1.66 0-26.99-23.83-26.99-25.39 0-0.2685 4.226-0.4876 9.391-0.4876zm16.13 1.727c0.0388-0.0118 0.0851-6e-3 0.1417 0.0231 9.674 5.087 20.32 9.107 27.58 10.41 2.293 0.4121 3.101 1.124 4.695 4.138 2.657 5.026 14.48 23 22.37 34.02 3.603 5.03 6.639 9.968 6.748 10.98 0.2897 2.671-2.108 2.658-7.285-0.0429-17.39-9.068-40.22-26.29-45.07-34.01-3.258-5.172-10.38-25.14-9.173-25.52zm67.9 9.71c0.263-9e-3 0.4337 9e-3 0.4876 0.0625 0.2159 0.2154 0.3921 6.837 0.3921 14.71 0 10.98-0.2506 14.62-1.074 15.62-1.615 1.956-3.397 1.59-6.909-1.423-4.068-3.49-7.665-9.13-10.4-16.3-3.912-10.28-4.082-9.686 2.985-10.28 3.355-0.2804 8.013-1.006 10.35-1.615 1.755-0.4562 3.373-0.7502 4.162-0.7776z"},null,-1),Dt=[zt];function Rt(i,t){return v(),w("svg",Ft,Dt)}var Ot=K(Mt,[["render",Rt]]);const At={},Nt={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Pt=e("path",{d:"m12 6c1.65 0 3-1.35 3-3s-1.35-3-3-3-3 1.35-3 3 1.35 3 3 3zm0 3c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3zm0 9c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3z"},null,-1),Vt=[Pt];function Bt(i,t){return v(),w("svg",Nt,Vt)}var Le=K(At,[["render",Bt]]);const jt={id:"filter"},Ut=D(" This is the main search & filter area"),Ht={id:"main"},Xt={class:"controls"},qt=e("span",{class:"spacer"},null,-1),Wt={class:"content"},Kt=D("This is the main area"),Yt={id:"details"},Gt={class:"controls"},Jt=e("span",{class:"spacer"},null,-1),Qt={class:"placeholder"},ae={emits:["detailVisibility"],setup(i,{expose:t,emit:u}){const{t:c}=X(),o=y(""),s=y("");function a(){o.value==""?(o.value="open-filter",s.value="",u("detailVisibility")):o.value=""}function _(){u("detailVisibility"),s.value==""?(s.value="open-details",o.value=""):s.value=""}function p(){u("detailVisibility"),s.value==""&&(s.value="open-details",o.value="")}return t({showDetails:p}),(x,k)=>(v(),w("main",{class:P([o.value,s.value])},[e("div",jt,[se(x.$slots,"filter",{},()=>[Ut])]),e("div",Ht,[e("div",Xt,[e("button",{onClick:a,class:"open-filter icon"},[g(Et)]),qt,e("button",{onClick:_,class:"open-details icon"},[g(Le)])]),e("div",Wt,[se(x.$slots,"main",{},()=>[Kt])])]),e("div",Yt,[e("div",Gt,[se(x.$slots,"head-details"),Jt,e("button",{onClick:_,class:"open-details icon"},[g(ve)])]),se(x.$slots,"details",{},()=>[e("div",Qt,[g(Ot),e("p",null,l(n(c)("details.noitem")),1)])])])],2))}},Zt=["placeholder"],en=D("Additional filters"),Ie={props:["data","placeholder"],emits:["result"],setup(i,{emit:t}){const u=i;var c=void 0;function o(a){a.preventDefault(),clearTimeout(c),c=setTimeout(function(){s(a.target.closest("form"))},500)}function s(a){let _=new FormData(a),p=u.data.filter(x=>{let k=x.size||1;for(let b of _.keys()){if(b=="name"){let r=_.get(b).toLowerCase();if(!x[b].toLowerCase().includes(r))return!1;continue}let[C,f]=_.getAll(b).map(r=>parseFloat(r));if(!isNaN(C)&&!isNaN(f)&&(x[b]/k<C||f<x[b]/k))return!1}return!0});t("result",p)}return(a,_)=>(v(),w("form",null,[e("input",{type:"text",name:"name",placeholder:i.placeholder,onInput:o},null,40,Zt),se(a.$slots,"default",{confirm:o},()=>[en])]))}};const tn={class:"slider"},nn=["name","value"],ln=D(" \xA0\u2013\xA0 "),an=["name","value"],on={class:"bar"},sn={class:"slide"},un=e("div",{class:"interact-area"},null,-1),cn=[un],rn=e("div",{class:"interact-area"},null,-1),dn=[rn],j={props:["label","name","unit","min","max","frac"],emits:["input"],setup(i,{emit:t}){const u=i,{t:c}=X(),o=y(parseFloat(u.min).toFixed(u.frac)),s=y(parseFloat(u.max).toFixed(u.frac)),a=y(0),_=y(100);ke(()=>u.min,(m,d)=>p(m)),ke(()=>u.max,(m,d)=>x(m));function p(m){let d=parseFloat(u.min)||0,h=parseFloat(m)||d;o.value=h,s.value=Math.max(o.value,s.value);let E=parseFloat(u.max)||0;a.value=(h-d)*100/(E-d),_.value=Math.max(a.value,_.value)}function x(m){let d=parseFloat(u.max)||0,h=parseFloat(m)||d;s.value=h,o.value=Math.min(o.value,s.value);let E=parseFloat(u.min)||0;_.value=(h-E)*100/(d-E),a.value=Math.min(a.value,_.value)}function k(m){m.target.blur(),p(m.target.value),t("input",m)}function b(m){m.target.blur(),x(m.target.value),t("input",m)}function C(m){let h=m.target.closest(".slide").getBoundingClientRect(),E=m.pageX!==void 0?m.pageX:m.changedTouches[0].pageX;E=Math.min(Math.max(E-h.left,0),h.width);let L=E*100/h.width,I=parseFloat(u.min)||0,O=parseFloat(u.max)||0,q=L/100*(O-I)+I;m.target.closest("button").classList.contains("min")?(o.value=q.toFixed(u.frac),s.value=Math.max(o.value,s.value),a.value=L,_.value=Math.max(a.value,_.value)):(s.value=q.toFixed(u.frac),o.value=Math.min(o.value,s.value),_.value=L,a.value=Math.min(a.value,_.value)),t("input",m)}function f(m){let d=m.target.closest("button");d.addEventListener("mousemove",C),d.addEventListener("touchmove",C),d.addEventListener("mouseup",r),d.addEventListener("touchend",r),d.addEventListener("mouseleave",r),d.addEventListener("touchcancel",r),d.classList.add("active")}function r(m){let d=m.target.closest("button");d.removeEventListener("mousemove",C),d.removeEventListener("touchmove",C),d.removeEventListener("mouseup",r),d.removeEventListener("touchend",r),d.removeEventListener("mouseleave",r),d.removeEventListener("touchcancel",r),d.classList.remove("active")}return(m,d)=>(v(),w("div",tn,[e("label",null,[e("span",null,l(i.label)+" ("+l(n(c)("unit."+i.unit))+")",1),e("input",{type:"text",name:i.name,value:o.value,onChange:k},null,40,nn),ln,e("input",{type:"text",name:i.name,value:s.value,onChange:b},null,40,an)]),e("div",on,[e("div",sn,[e("div",{class:"overlay",style:ge({left:a.value+"%",right:100-_.value+"%"})},null,4),e("button",{type:"button",class:"handle min",style:ge({left:a.value+"%"}),onMousedown:f,onTouchstart:f},cn,36),e("button",{type:"button",class:"handle max",style:ge({left:_.value+"%"}),onMousedown:f,onTouchstart:f},dn,36)])])]))}};const mn={class:"clickable-input"},vn=["placeholder"],hn=["value"],Se={props:["label","placeholder"],emits:["confirm"],setup(i,{emit:t}){const u=y("");function c(o){o.preventDefault(),t("confirm",u.value),u.value=""}return(o,s)=>(v(),w("form",mn,[te(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>u.value=a),placeholder:i.placeholder},null,8,vn),[[ye,u.value]]),e("input",{type:"submit",onClick:c,value:i.label},null,8,hn)]))}};const _n={class:"clickable-select"},fn={value:"0",selected:""},pn=["value"],gn=["disabled"],bn={props:["label","placeholder","items","disabled"],emits:["confirm"],setup(i,{emit:t}){const u=i,{locale:c}=X(),o=y(0),s=new Intl.Collator(c.value,{numeric:!0}),a=G(()=>[...u.items].sort((p,x)=>s.compare(p.name,x.name)));function _(p){p.preventDefault(),o.value&&t("confirm",o.value)}return(p,x)=>(v(),w("form",_n,[te(e("select",{"onUpdate:modelValue":x[0]||(x[0]=k=>o.value=k)},[e("option",fn,l(i.placeholder),1),(v(!0),w(W,null,Q(n(a),k=>(v(),w("option",{key:k.id,value:k.id},l(k.name),9,pn))),128))],512),[[be,o.value]]),e("button",{type:"submit",class:"async",onClick:_,disabled:i.disabled},l(i.label),9,gn)]))}};const yn={class:"clickable-date"},$n=["value"],wn=["value"],kn=["disabled"],Te={props:["label","date","time","disabled"],emits:["confirm"],setup(i,{emit:t}){function u(c){c.preventDefault();let o=new FormData(c.target.closest("form"));t("confirm",o.get("date"),o.get("time"))}return(c,o)=>(v(),w("form",yn,[e("input",{type:"date",name:"date",value:i.date},null,8,$n),e("input",{type:"time",name:"time",value:i.time},null,8,wn),e("button",{type:"submit",class:"async",onClick:u,disabled:i.disabled},l(i.label),9,kn)]))}};const xn={},Cn={class:"icon sort-arrow"};function Ln(i,t){return v(),w("span",Cn)}var oe=K(xn,[["render",Ln]]);const In=["onClick"],Sn={class:"name"},Tn={class:"num"},En={class:"unit"},Mn={class:"m num"},Fn={class:"unit"},zn={class:"m num"},Dn={class:"unit"},Rn={class:"m num"},On={class:"unit"},Ee={props:["items"],emits:"selected",setup(i,{emit:t}){const u=i,{t:c,locale:o}=X(),s=y("name"),a=y("asc"),_=new Intl.Collator(o.value,{numeric:!0}),p=G(()=>a.value=="asc"?[...u.items].sort((b,C)=>_.compare(b[s.value],C[s.value])):[...u.items].sort((b,C)=>-_.compare(b[s.value],C[s.value])));function x(b,C,f=1){return C?+parseFloat(b/C).toFixed(f):b}function k(b){let C=b.target.dataset.sort;s.value==C?a.value=a.value=="asc"?"desc":"asc":s.value=C}return(b,C)=>(v(),w("table",null,[e("thead",null,[e("tr",{class:P(a.value)},[e("th",{class:P(["name sort",{active:s.value=="name"}]),onClick:k,"data-sort":"name"},[D(l(n(c)("food.name"))+" ",1),g(oe)],2),e("th",{class:P(["num sort",{active:s.value=="kcal"}]),onClick:k,"data-sort":"kcal"},[g(oe),D(" "+l(n(c)("food.energy")),1)],2),e("th",{class:P(["m num sort",{active:s.value=="fat"}]),onClick:k,"data-sort":"fat"},[g(oe),D(" "+l(n(c)("food.fat")),1)],2),e("th",{class:P(["m num sort",{active:s.value=="carb"}]),onClick:k,"data-sort":"carb"},[g(oe),D(" "+l(n(c)("food.carbs2")),1)],2),e("th",{class:P(["m num sort",{active:s.value=="prot"}]),onClick:k,"data-sort":"prot"},[g(oe),D(" "+l(n(c)("food.protein")),1)],2)],2)]),e("tbody",null,[(v(!0),w(W,null,Q(n(p),f=>(v(),w("tr",{key:f.id,onClick:r=>b.$emit("selected",f.id)},[e("td",Sn,l(f.name),1),e("td",Tn,[D(l(x(f.kcal,f.size))+" ",1),e("span",En,l(n(c)("unit.cal")),1)]),e("td",Mn,[D(l(x(f.fat,f.size))+" ",1),e("span",Fn,l(n(c)("unit.g")),1)]),e("td",zn,[D(l(x(f.carb,f.size))+" ",1),e("span",Dn,l(n(c)("unit.g")),1)]),e("td",Rn,[D(l(x(f.prot,f.size))+" ",1),e("span",On,l(n(c)("unit.g")),1)])],8,In))),128))])]))}},An={},Nn={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Pn=e("path",{d:"m-7.5e-8 19.001v4.9993h4.9993l14.745-14.745-4.9993-4.9993zm23.61-13.611c0.51993-0.51993 0.51993-1.3598 0-1.8797l-3.1196-3.1196c-0.51993-0.51993-1.3598-0.51993-1.8797 0l-2.4397 2.4397 4.9993 4.9993z"},null,-1),Vn=[Pn];function Bn(i,t){return v(),w("svg",Nn,Vn)}var $e=K(An,[["render",Bn]]);const jn={key:0,class:"new-item"},Un=e("hr",null,null,-1),Hn=e("section",{class:"subtitle"},"Some food category",-1),Xn={class:"tags"},qn=e("span",{class:"tag"},"Tag 1",-1),Wn=e("span",{class:"tag"},"Tag 2",-1),Kn=e("span",{class:"tag"},"Tag 3",-1),Yn=["disabled"],Gn=e("hr",null,null,-1),Jn={class:"tracking no-edit-mode"},Qn={class:"tracking-amount"},Zn={class:"unit"},el=e("label",null,"Add to recipe",-1),tl=e("label",null,"Add to diary",-1),nl=e("hr",null,null,-1),ll={class:"nutrient-block"},al=["disabled"],ol=["value"],sl={class:"unit"},il=["value"],ul={class:"unit"},cl=["value"],rl={class:"unit"},dl=["value"],ml={class:"unit"},vl=["value"],hl={class:"unit"},_l=["disabled"],fl=["value"],pl={class:"unit"},gl=["value"],bl={class:"unit"},yl=["value"],$l={class:"unit"},wl=["value"],kl={class:"unit"},xl=["value"],Cl={class:"unit"},Ll={setup(i){const{t}=X(),u=U("log"),c=U("csrfToken"),o=U("perms"),s=U("food"),a=U("recipes"),_=y([]),p=y(null),x=y(!1),k=y(!1),b=y(!1),C=y(!1),f=y(100),r=y(A.now().toISODate()),m=y(A.now().toLocaleString(A.TIME_24_SIMPLE)),d=y(null),h=y(null);function E(R){fetch("/api/v1/food",{method:"POST",headers:{"X-CSRF-Token":c}}).then($=>{if(!$.ok)throw t("createfood.err"+$.status);return $.json()}).then($=>{$.name=R,s.value.push($),_.value.push($),u.msg(t("createfood.ok")),ce($.id)}).catch($=>u.err($))}function L(){k.value=!0;let R=p.value.id;fetch("/api/v1/food/"+R,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":c},body:new URLSearchParams(new FormData(h.value))}).then($=>{if(!$.ok)throw t("savefood.err"+$.status);return x.value=!1,fetch("/api/v1/food/"+R)}).then($=>$.json()).then($=>{$.name=t($.id.toString()),s.value=s.value.map(M=>$.id==M.id?$:M),_.value=_.value.map(M=>$.id==M.id?$:M),p.value=p.value.id==$.id?$:p.value,u.msg(t("savefood.ok"))}).catch($=>u.err($)).finally(()=>{setTimeout(function(){k.value=!1},500)})}function I(R){b.value=!0,fetch(`/api/v1/recipe/${R}/ingredient/${p.value.id}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":c},body:new URLSearchParams({amount:f.value})}).then($=>{if(!$.ok)throw t("addfood.err"+$.status);return fetch("/api/v1/recipe/"+R)}).then($=>$.json()).then($=>{a.value=a.value.map(M=>$.id==M.id?$:M),f.value=100,u.msg(t("addfood.ok"))}).catch($=>u.err($)).finally(()=>{setTimeout(function(){b.value=!1},500)})}function O(R,$){C.value=!0,fetch(`/api/v1/diary/${R}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":c},body:new URLSearchParams({id:p.value.id,amount:f.value,time:$})}).then(M=>{if(!M.ok)throw t("adddiary.err"+M.status);f.value=100,u.msg(t("adddiary.ok"))}).catch(M=>u.err(M)).finally(()=>{setTimeout(function(){C.value=!1},500)})}function q(R){_.value=R,p.value&&_.value.filter($=>$.id==p.value.id).length==0&&(p.value=null)}function ce(R){p.value=_.value.filter($=>$.id==R)[0],r.value=A.now().toISODate(),m.value=A.now().toLocaleString(A.TIME_24_SIMPLE),f.value=100,d.value.showDetails()}function re(){x.value?L():x.value=!0}function H(R){R.target.blur(),isNaN(parseFloat(R.target.value))&&(R.target.value=p.value[R.target.name])}return(R,$)=>(v(),B(ae,{ref_key:"main",ref:d,onDetailVisibility:$[1]||($[1]=M=>x.value=!1),class:P({"edit-mode":x.value})},Ce({filter:z(()=>[n(o).canCreateFood?(v(),w("section",jn,[e("h2",null,l(n(t)("aria.headnew")),1),g(Se,{label:n(t)("btn.new"),placeholder:n(t)("food.hintnew"),onConfirm:E},null,8,["label","placeholder"])])):V("",!0),Un,e("section",null,[e("h2",null,l(n(t)("aria.headsearch")),1),g(Ie,{data:n(s),placeholder:n(t)("food.hintsearch"),onResult:q},{default:z(M=>[e("fieldset",null,[e("legend",null,l(n(t)("aria.headmacro1")),1),g(j,{label:n(t)("food.energy"),onInput:M.confirm,name:"kcal",unit:"cal",min:"0",max:"900",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.fat"),onInput:M.confirm,name:"fat",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.carbs"),onInput:M.confirm,name:"carb",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.protein"),onInput:M.confirm,name:"prot",unit:"g",min:"0",max:"89",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.fiber"),onInput:M.confirm,name:"fib",unit:"g",min:"0",max:"71",frac:"0"},null,8,["label","onInput"])]),e("fieldset",null,[e("legend",null,l(n(t)("aria.headmacro2")),1),g(j,{label:n(t)("food.fatsat"),onInput:M.confirm,name:"fatsat",unit:"g",min:"0",max:"83",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.fato3"),onInput:M.confirm,name:"fato3",unit:"g",min:"0",max:"54",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.fato6"),onInput:M.confirm,name:"fato6",unit:"g",min:"0",max:"70",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.sugar"),onInput:M.confirm,name:"sug",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),g(j,{label:n(t)("food.salt"),onInput:M.confirm,name:"salt",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"])])]),_:1},8,["data","placeholder"])])]),main:z(()=>[g(Ee,{items:_.value,onSelected:ce},null,8,["items"])]),_:2},[p.value?{name:"head-details",fn:z(()=>[e("h2",null,l(p.value.name),1)])}:void 0,p.value?{name:"details",fn:z(()=>[Hn,e("section",Xn,[qn,Wn,Kn,n(o).canCreateFood||n(o).canEditFood?(v(),w("button",{key:0,class:"icon async",disabled:k.value,onClick:re},[x.value?V("",!0):(v(),B($e,{key:0})),x.value?(v(),B(_e,{key:1})):V("",!0)],8,Yn)):V("",!0)]),Gn,e("section",Jn,[e("h2",null,l(n(t)("aria.headtrack")),1),e("fieldset",Qn,[e("div",null,[e("label",null,l(n(t)("food.amount")),1),te(e("input",{type:"number","onUpdate:modelValue":$[0]||($[0]=M=>f.value=M),name:"amount"},null,512),[[ye,f.value]]),e("span",Zn,l(n(t)("unit.g")),1)])]),e("fieldset",null,[el,g(bn,{label:n(t)("btn.add"),placeholder:n(t)("food.hintrec"),items:n(a),disabled:b.value,onConfirm:I},null,8,["label","placeholder","items","disabled"])]),e("fieldset",null,[tl,g(Te,{label:n(t)("btn.add"),time:m.value,date:r.value,disabled:C.value,onConfirm:O},null,8,["label","time","date","disabled"])])]),nl,e("section",null,[e("h2",null,l(n(t)("aria.headnutrients")),1),e("form",{ref_key:"form",ref:h},[e("div",ll,[e("fieldset",{disabled:!x.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("food.energy")),1),e("input",{type:"text",value:p.value.kcal,name:"kcal",onChange:H},null,40,ol),e("span",sl,l(n(t)("unit.cal")),1)]),e("div",null,[e("label",null,l(n(t)("food.fat")),1),e("input",{type:"text",value:p.value.fat,name:"fat",onChange:H},null,40,il),e("span",ul,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.carbs2")),1),e("input",{type:"text",value:p.value.carb,name:"carb",onChange:H},null,40,cl),e("span",rl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.protein")),1),e("input",{type:"text",value:p.value.prot,name:"prot",onChange:H},null,40,dl),e("span",ml,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fiber")),1),e("input",{type:"text",value:p.value.fib,name:"fib",onChange:H},null,40,vl),e("span",hl,l(n(t)("unit.g")),1)])],8,al),e("fieldset",{disabled:!x.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("food.fatsat")),1),e("input",{type:"text",value:p.value.fatsat,name:"fatsat",onChange:H},null,40,fl),e("span",pl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fato3")),1),e("input",{type:"text",value:p.value.fato3,name:"fato3",onChange:H},null,40,gl),e("span",bl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fato6")),1),e("input",{type:"text",value:p.value.fato6,name:"fato6",onChange:H},null,40,yl),e("span",$l,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.sugar")),1),e("input",{type:"text",value:p.value.sug,name:"sug",onChange:H},null,40,wl),e("span",kl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.salt")),1),e("input",{type:"text",value:p.value.salt,name:"salt",onChange:H},null,40,xl),e("span",Cl,l(n(t)("unit.g")),1)])],8,_l)])],512)])])}:void 0]),1032,["class"]))}};const Il=["disabled"],Sl=["value"],Tl={class:"unit"},El=["value"],Ml={props:["items","disabled"],setup(i,{expose:t}){const u=i,{t:c,locale:o}=X(),s=y("name"),a=y(null),_=new Intl.Collator(o.value,{numeric:!0}),p=G(()=>u.items.map(C=>({id:C.id,amount:C.amount,name:c(C.id.toString())})).sort((C,f)=>_.compare(C[s.value],f[s.value])));function x(b){b.target.blur();let C=parseFloat(b.target.value);(isNaN(C)||C<0)&&(b.target.value=0)}function k(){let b=new FormData(a.value),C=b.getAll("id"),f=b.getAll("amount"),r=[];return u.items.forEach(m=>{let d=parseInt(C.indexOf(m.id.toString())),h=parseFloat(f[d]);h!=m.amount&&r.push({id:m.id,amount:h})}),r}return t({getDiff:k}),(b,C)=>(v(),w("form",{class:"ingredients",ref_key:"form",ref:a},[e("fieldset",{disabled:i.disabled},[(v(!0),w(W,null,Q(n(p),f=>(v(),w("div",{key:f.id},[e("label",null,l(f.name),1),e("input",{type:"number",name:"amount",value:f.amount,onChange:x},null,40,Sl),e("span",Tl,l(n(c)("unit.g")),1),e("input",{type:"hidden",name:"id",value:f.id},null,8,El)]))),128))],8,Il)],512))}},Fl={},zl={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Dl=e("path",{d:"m0 18.316h2.5263v0.63158h-1.2632v1.2632h1.2632v0.63158h-2.5263v1.2632h3.7895v-5.0526h-3.7895zm1.2632-11.368h1.2632v-5.0526h-2.5263v1.2632h1.2632zm-1.2632 3.7895h2.2737l-2.2737 2.6526v1.1368h3.7895v-1.2632h-2.2737l2.2737-2.6526v-1.1368h-3.7895zm6.3158-7.5789v2.5263h17.684v-2.5263zm0 17.684h17.684v-2.5263h-17.684zm0-7.5789h17.684v-2.5263h-17.684z"},null,-1),Rl=[Dl];function Ol(i,t){return v(),w("svg",zl,Rl)}var Al=K(Fl,[["render",Ol]]);const Nl={class:"new-item"},Pl=e("hr",null,null,-1),Vl=["disabled"],Bl=["value"],jl=["innerHTML"],Ul={class:"tags"},Hl=e("span",{class:"tag no-edit-mode"},"Tag 1",-1),Xl=e("span",{class:"tag no-edit-mode"},"Tag 2",-1),ql=e("span",{class:"tag no-edit-mode"},"Tag 3",-1),Wl=["disabled"],Kl=e("hr",null,null,-1),Yl={key:0,class:"tracking no-edit-mode"},Gl={class:"tracking-amount"},Jl={class:"unit"},Ql=e("label",null,"Add to diary",-1),Zl=e("hr",null,null,-1),ea=["innerHTML"],ta=e("hr",null,null,-1),na={class:"no-edit-mode"},la={class:"nutrient-block"},aa={class:"col50"},oa={class:"unit"},sa={class:"unit"},ia={class:"col50"},ua={class:"unit"},ca={class:"unit"},ra=e("hr",null,null,-1),da={class:"prep"},ma=["disabled"],va={class:"prep-size"},ha=["value"],_a=["disabled"],fa=["value"],pa={class:"unit"},ga=["value"],ba={class:"unit"},ya=["value"],$a={class:"unit"},wa=["value"],ka={class:"unit"},xa={class:"placeholder"},Ca={setup(i){const{t}=X(),u=U("log"),c=U("csrfToken");U("perms");const o=U("recipes"),s=y([]),a=y(null),_=y(!1),p=y(!1),x=y(!1),k=y(1),b=y("&nbsp;"),C=y(A.now().toISODate()),f=y(A.now().toLocaleString(A.TIME_24_SIMPLE)),r=y(null),m=y(null),d=y(null);function h(T,S=2){return+parseFloat(T/(a.value.size||1)).toFixed(S)}function E(T){return Math.min.apply(Math,o.value.map(S=>Math.floor(S[T]/S.size)))}function L(T){return Math.max.apply(Math,o.value.map(S=>Math.ceil(S[T]/S.size)))}function I(T){fetch("/api/v1/recipe",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":c},body:new URLSearchParams({name:T})}).then(S=>{if(!S.ok)throw t("createrec.err"+S.status);return S.json()}).then(S=>{S.isowner=!0,o.value.push(S),s.value.push(S),u.msg(t("createrec.ok")),re(S.id)}).catch(S=>u.err(S))}function O(){p.value=!0;let T=a.value.id,S=a.value.owner,N=a.value.isowner;fetch("/api/v1/recipe/"+T,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":c},body:new URLSearchParams(new FormData(m.value))}).then(F=>{if(!F.ok)throw t("saverec.err"+F.status);return q(T)}).then(()=>fetch("/api/v1/recipe/"+T)).then(F=>F.json()).then(F=>{F.owner=S,F.isowner=N,o.value=o.value.map(J=>F.id==J.id?F:J),s.value=s.value.map(J=>F.id==J.id?F:J),a.value=a.value.id==F.id?F:a.value,u.msg(t("saverec.ok"))}).catch(F=>u.err(F)).finally(()=>{setTimeout(function(){p.value=!1},500)})}function q(T){let S=d.value.getDiff();return S.length==0?new Promise(N=>{_.value=!1,N()}):new Promise((N,F)=>{let J=0,pe;S.forEach(we=>{fetch(`/api/v1/recipe/${T}/ingredient/${we.id}`,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":c},body:new URLSearchParams({amount:we.amount})}).then(me=>{if(++J,!me.ok)throw t("saverec.err"+me.status)}).catch(me=>pe=me).finally(()=>{J==S.length&&(pe?F(pe):(_.value=!1,N()))})})})}function ce(T,S){x.value=!0;let N=new URLSearchParams({recipe:a.value.name});a.value.items.forEach(F=>{N.append("id",F.id),N.append("amount",h(F.amount)*k.value),N.append("time",S)}),fetch(`/api/v1/diary/${T}`,{method:"POST",body:N,headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":c}}).then(F=>{if(!F.ok)throw t("adddiary.err"+F.status);k.value=1,u.msg(t("adddiary.ok"))}).catch(F=>u.err(F)).finally(()=>{setTimeout(function(){x.value=!1},500)})}function re(T){a.value=s.value.filter(S=>S.id==T)[0],C.value=A.now().toISODate(),f.value=A.now().toLocaleString(A.TIME_24_SIMPLE),k.value=1,r.value.showDetails(),"isowner"in a.value?R():H()}function H(){fetch(`/api/v1/recipe/${a.value.id}/owner`).then(T=>{if(!T.ok)throw T;return T.json()}).then(T=>{a.value.isowner=T.isowner,a.value.owner=T.owner,R()}).catch(()=>{u.err(t("recowner.err")),b.value="&nbsp;"})}function R(){a.value.isowner?b.value=t("recipe.isowner"):a.value.owner?b.value=t("recipe.owner",{name:a.value.owner}):b.value=t("recipe.ispublic")}function $(T){s.value=T,a.value&&s.value.filter(S=>S.id==a.value.id).length==0&&(a.value=null)}function M(){_.value?O():_.value=!0}function de(T){T.target.blur(),isNaN(parseFloat(T.target.value))&&(T.target.value=a.value[T.target.name])}return ie(()=>s.value=[...o.value]),(T,S)=>(v(),B(ae,{ref_key:"main",ref:r,onDetailVisibility:S[1]||(S[1]=N=>_.value=!1),class:P({"edit-mode":_.value})},Ce({filter:z(()=>[e("section",Nl,[e("h2",null,l(n(t)("aria.headnewrec")),1),g(Se,{label:n(t)("btn.new"),placeholder:n(t)("recipe.hintnew"),onConfirm:I},null,8,["label","placeholder"])]),Pl,e("section",null,[e("h2",null,l(n(t)("aria.headsearch")),1),g(Ie,{data:n(o),placeholder:n(t)("recipe.hintsearch"),onResult:$},{default:z(N=>[e("fieldset",null,[g(j,{label:n(t)("food.energy"),min:E("kcal"),max:L("kcal"),onInput:N.confirm,name:"kcal",unit:"cal",frac:"0"},null,8,["label","min","max","onInput"]),g(j,{label:n(t)("food.fat"),min:E("fat"),max:L("fat"),onInput:N.confirm,name:"fat",unit:"g",frac:"0"},null,8,["label","min","max","onInput"]),g(j,{label:n(t)("food.carbs"),min:E("carb"),max:L("carb"),onInput:N.confirm,name:"carb",unit:"g",frac:"0"},null,8,["label","min","max","onInput"]),g(j,{label:n(t)("food.protein"),min:E("prot"),max:L("prot"),onInput:N.confirm,name:"prot",unit:"g",frac:"0"},null,8,["label","min","max","onInput"])])]),_:1},8,["data","placeholder"])])]),main:z(()=>[g(Ee,{items:s.value,onSelected:re},null,8,["items"])]),_:2},[a.value?{name:"head-details",fn:z(()=>[e("form",{ref_key:"form",ref:m,autocomplete:"off",id:"form-recipe"},[e("fieldset",{disabled:!_.value},[e("input",{type:"text",name:"name",value:a.value.name},null,8,Bl)],8,Vl)],512)])}:void 0,a.value?{name:"details",fn:z(()=>[e("section",{class:"subtitle no-edit-mode",innerHTML:b.value},null,8,jl),e("section",Ul,[Hl,Xl,ql,a.value.isowner?(v(),w("button",{key:0,class:"icon async",disabled:p.value,onClick:M},[_.value?V("",!0):(v(),B($e,{key:0})),_.value?(v(),B(_e,{key:1})):V("",!0)],8,Wl)):V("",!0)]),Kl,a.value.items.length?(v(),w("section",Yl,[e("h2",null,l(n(t)("aria.headtrack")),1),e("fieldset",Gl,[e("div",null,[e("label",null,l(n(t)("food.amount")),1),te(e("input",{type:"number","onUpdate:modelValue":S[0]||(S[0]=N=>k.value=N),name:"amount"},null,512),[[ye,k.value]]),e("span",Jl,l(n(t)("recipe.size",k.value)),1)])]),e("fieldset",null,[Ql,g(Te,{label:n(t)("btn.add"),time:f.value,date:C.value,disabled:x.value,onConfirm:ce},null,8,["label","time","date","disabled"])])])):V("",!0),Zl,e("section",null,[e("h2",null,l(n(t)("aria.headingred")),1),a.value.items.length?V("",!0):(v(),w("p",{key:0,class:"msg-noitems",innerHTML:n(t)("recipe.noitems")},null,8,ea)),g(Ml,{ref_key:"ingredients",ref:d,items:a.value.items,disabled:!_.value},null,8,["items","disabled"])]),ta,e("section",na,[e("h2",null,l(n(t)("aria.headnutrients")),1),e("div",la,[e("div",aa,[e("div",null,[e("label",null,l(n(t)("food.energy")),1),e("span",null,l(h(a.value.kcal,1)),1),e("span",oa,l(n(t)("unit.cal")),1)]),e("div",null,[e("label",null,l(n(t)("food.fat")),1),e("span",null,l(h(a.value.fat,1)),1),e("span",sa,l(n(t)("unit.g")),1)])]),e("div",ia,[e("div",null,[e("label",null,l(n(t)("food.carbs2")),1),e("span",null,l(h(a.value.carb,1)),1),e("span",ua,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.protein")),1),e("span",null,l(h(a.value.prot,1)),1),e("span",ca,l(n(t)("unit.g")),1)])])])]),ra,e("section",da,[e("h2",null,l(n(t)("aria.headprep")),1),e("div",null,[e("fieldset",{disabled:!_.value,class:"col50"},[e("div",va,[e("label",null,l(n(t)("recipe.size",2)),1),e("input",{type:"text",name:"size",form:"form-recipe",value:a.value.size,onChange:de},null,40,ha),e("label",null,l(n(t)("recipe.size",a.value.size)),1)])],8,ma),e("fieldset",{disabled:!_.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("recipe.time")),1),e("input",{type:"text",disabled:"",value:a.value.preptime+a.value.cooktime+a.value.misctime},null,8,fa),e("span",pa,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.preptime")),1),e("input",{type:"text",name:"preptime",form:"form-recipe",value:a.value.preptime,onChange:de},null,40,ga),e("span",ba,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.cooktime")),1),e("input",{type:"text",name:"cooktime",form:"form-recipe",value:a.value.cooktime,onChange:de},null,40,ya),e("span",$a,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.misctime")),1),e("input",{type:"text",name:"misctime",form:"form-recipe",value:a.value.misctime,onChange:de},null,40,wa),e("span",ka,l(n(t)("unit.min")),1)])],8,_a)]),e("div",xa,[g(Al),e("p",null,l(n(t)("todo.instructions")),1)])])])}:void 0]),1032,["class"]))}};const La=["disabled"],Ia={value:"1"},Sa={value:"2"},Ta={value:"3"},Ea={value:"4"},Ma={value:"5"},Fa={value:"6"},za={value:"7"},Da={value:"8"},Ra={value:"9"},Oa={value:"10"},Aa={value:"11"},Na={value:"12"},Pa=["value"],Va=["disabled"],Me={props:["mode","items"],emits:["selection"],setup(i,{emit:t}){const u=i,{t:c}=X(),o=y(A.now().month),s=y(A.now().year),a=y(null),_=G(()=>{let m=u.items.map(d=>parseInt(d.split("-")[0])).filter((d,h,E)=>E.indexOf(d)===h);return[Math.min(...m)-1,...m,Math.max(...m)+1]}),p=G(()=>s.value!=_.value[0]||o.value>1),x=G(()=>s.value!=_.value[_.value.length-1]||o.value<12);let k=[];function b(){let m=A.now().toISODate(),d=A.local(s.value,o.value);d=d.minus({days:d.weekday}),!k.length&&u.mode!="toggle"&&(k=[m]),a.value.querySelectorAll("td").forEach(h=>{let E=d.toISODate();h.firstElementChild.textContent=d.day,h.firstElementChild.dataset.date=E,d.month!=o.value?h.classList.add("outside"):h.classList.remove("outside"),E==m?h.classList.add("today"):h.classList.remove("today"),u.items.indexOf(E)!=-1?h.classList.add("has-entries"):h.classList.remove("has-entries"),k.indexOf(E)!=-1?h.classList.add("active"):h.classList.remove("active"),d=d.plus({days:1})})}function C(){--o.value<1&&(o.value=12,--s.value),b()}function f(){++o.value>12&&(o.value=1,++s.value),b()}function r(m){let d=m.target.dataset.date;if(u.mode=="toggle"){let h=k.indexOf(d);h==-1?k.push(d):k.splice(h,1)}else k=[d];a.value.querySelectorAll("td>button").forEach(h=>{k.indexOf(h.dataset.date)!=-1?h.parentNode.classList.add("active"):h.parentNode.classList.remove("active")}),t("selection",k)}return ie(()=>{b(),t("selection",k)}),(m,d)=>(v(),w("div",{class:P(["calendar",[i.mode]])},[e("div",null,[e("button",{class:"prev icon",onClick:C,disabled:!n(p)},[g(ve)],8,La),e("div",null,[te(e("select",{class:"month","onUpdate:modelValue":d[0]||(d[0]=h=>o.value=h),onChange:b},[e("option",Ia,l(n(c)("month.1")),1),e("option",Sa,l(n(c)("month.2")),1),e("option",Ta,l(n(c)("month.3")),1),e("option",Ea,l(n(c)("month.4")),1),e("option",Ma,l(n(c)("month.5")),1),e("option",Fa,l(n(c)("month.6")),1),e("option",za,l(n(c)("month.7")),1),e("option",Da,l(n(c)("month.8")),1),e("option",Ra,l(n(c)("month.9")),1),e("option",Oa,l(n(c)("month.10")),1),e("option",Aa,l(n(c)("month.11")),1),e("option",Na,l(n(c)("month.12")),1)],544),[[be,o.value,void 0,{number:!0}]]),te(e("select",{class:"year","onUpdate:modelValue":d[1]||(d[1]=h=>s.value=h),onChange:b},[(v(!0),w(W,null,Q(n(_),h=>(v(),w("option",{value:h},l(h),9,Pa))),256))],544),[[be,s.value,void 0,{number:!0}]])]),e("button",{class:"next icon",onClick:f,disabled:!n(x)},[g(ve)],8,Va)]),e("table",{ref_key:"calendar",ref:a},[e("thead",null,[e("tr",null,[e("th",null,l(n(c)("day.cal7")),1),e("th",null,l(n(c)("day.cal1")),1),e("th",null,l(n(c)("day.cal2")),1),e("th",null,l(n(c)("day.cal3")),1),e("th",null,l(n(c)("day.cal4")),1),e("th",null,l(n(c)("day.cal5")),1),e("th",null,l(n(c)("day.cal6")),1)])]),e("tbody",null,[e("tr",null,[e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})])]),e("tr",null,[e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})])]),e("tr",null,[e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})])]),e("tr",null,[e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})])]),e("tr",null,[e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})])]),e("tr",null,[e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})]),e("td",null,[e("button",{onClick:r})])])])],512)],2))}};const Ba={class:"unit"},ja=["disabled"],Ua=["value"],Ha={class:"unit"},Xa=["value"],qa=["value","disabled"],Wa={class:"unit"},Ka=["value"],Ya={props:["entries","disabled"],setup(i,{expose:t}){const u=i,{t:c,locale:o}=X(),s=y("hour"),a=y(null);new Intl.Collator(o.value,{numeric:!0});const _=G(()=>{switch(s.value){case"hour":return p();case"day":return x();default:return[]}});function p(){let f=[];if(u.entries){let r={};u.entries.forEach(m=>{let d=parseInt(m.time),h=A.fromObject({hours:d-d%2}),E=h.toFormat("t")+" - "+h.plus({hours:2}).toFormat("t");E in r||(r[E]={name:E,entries:[]});let L={name:c(m.food.id.toString()),amount:m.food.amount,isrec:!1,id:m.food.id};if(m.recipe){let I=!1;r[E].entries.every(O=>{if(O.name==m.recipe)return O.entries.push(L),O.amount+=L.amount,I=!0,!1}),I||r[E].entries.push({name:m.recipe,isrec:!0,amount:L.amount,entries:[L]})}else r[E].entries.push(L)}),f=Object.values(r),f.sort((m,d)=>m.name<d.name)}return f}function x(){return[{name:"Morning",entries:[{type:"recipe"},{type:"single"}]},{name:"Noon",entries:[{type:"recipe"},{type:"single"}]}]}function k(f){let r=f.target.closest("div"),m=r.querySelector("fieldset");m.style.setProperty("--max-height",m.childElementCount*41+"px"),r.classList.toggle("open")}function b(f){f.target.blur();let r=parseFloat(f.target.value);(isNaN(r)||r<0)&&(f.target.value=0)}function C(){let f=new FormData(a.value);return f.getAll("id"),f.getAll("amount"),[]}return t({getDiff:C}),(f,r)=>(v(),w("form",{class:"diary-entry-list",ref_key:"form",ref:a},[(v(!0),w(W,null,Q(n(_),m=>(v(),w("fieldset",{key:m.name},[e("legend",null,l(m.name),1),(v(!0),w(W,null,Q(m.entries,d=>(v(),w("div",{class:P({recipe:d.isrec})},[d.isrec?(v(),w(W,{key:0},[e("label",null,l(d.name),1),e("button",{class:"icon",type:"button",onClick:k},[g(Le)]),e("span",null,l(d.amount),1),e("span",Ba,l(n(c)("unit.g")),1),e("fieldset",{disabled:i.disabled},[(v(!0),w(W,null,Q(d.entries,h=>(v(),w("div",{key:h.id},[e("label",null,l(h.name),1),e("input",{type:"number",name:"amount",value:h.amount,onChange:b},null,40,Ua),e("span",Ha,l(n(c)("unit.g")),1),e("input",{type:"hidden",name:"id",value:h.id},null,8,Xa)]))),128))],8,ja)],64)):(v(),w(W,{key:1},[e("label",null,l(d.name),1),e("input",{type:"number",name:"amount",value:d.amount,disabled:i.disabled,onChange:b},null,40,qa),e("span",Wa,l(n(c)("unit.g")),1),e("input",{type:"hidden",name:"id",value:d.id},null,8,Ka)],64))],2))),256))]))),128))],512))}};const Ga=e("hr",null,null,-1),Ja=e("section",null,null,-1),Qa=D(" Diary "),Za={class:"no-edit-mode"},eo={class:"subtitle no-edit-mode"},to={class:"tabs"},no=["disabled"],lo=e("hr",null,null,-1),ao={key:0},oo=["innerHTML"],so={setup(i){const{t}=X(),u=U("log"),c=U("diary"),o=y(null),s=y(A.now()),a=y("kcal"),_=y(!1),p=y(!1),x=y(null),k=G(()=>Object.keys(c.value));let b=!1;function C(L){L.stopPropagation(),r(L.target.closest("ul"),L.movementX),b=!0}function f(L){L.stopPropagation();let I=Math.max(-16,Math.min(-L.deltaY,16));r(L.target.closest("ul"),I)}function r(L,I){let O=parseInt(L.style.getPropertyValue("--offset"))||0,q=Math.max(L.clientWidth-L.scrollWidth,Math.min(O+I,0));L.style.setProperty("--offset",q+"px")}function m(L){let I=L.target.closest("ul");I.addEventListener("pointermove",C),I.addEventListener("mouseup",d),I.addEventListener("touchend",d),I.addEventListener("mouseleave",d),I.addEventListener("touchcancel",d),b=!1}function d(L){let I=L.target.closest("ul");I.removeEventListener("pointermove",C),I.removeEventListener("mouseup",d),I.removeEventListener("touchend",d),I.removeEventListener("mouseleave",d),I.removeEventListener("touchcancel",d)}function h(L){b||(a.value=L.target.dataset.name)}function E(L){s.value=A.fromISO(L[0]);let I=s.value.toISODate();if(!c.value[I]){o.value={date:I};return}if(c.value[I].entries){o.value=c.value[I];return}fetch("/api/v1/diary/"+I.replaceAll("-","/")).then(O=>O.json()).then(O=>{O.forEach(q=>q.time=q.date.split("T")[1].slice(0,5)),c.value[I].entries=O}).catch(O=>u.err(O)).finally(()=>o.value=c.value[I])}return(L,I)=>(v(),B(ae,{ref_key:"main",ref:x,class:"diary"},{filter:z(()=>[e("section",null,[e("h2",null,l(n(t)("aria.headcal")),1),g(Me,{items:n(k),onSelection:E},null,8,["items"])]),Ga,Ja]),main:z(()=>[Qa]),"head-details":z(()=>[e("h2",Za,l(s.value.weekdayLong),1)]),details:z(()=>[e("section",eo,l(s.value.toLocaleString(n(A).DATE_FULL)),1),e("section",to,[e("div",null,[e("ul",{onMousedown:m,onTouchstart:m,onWheel:f},[e("li",{class:P({active:a.value=="kcal"})},[e("button",{"data-name":"kcal",onClick:h},l(n(t)("food.energy")),1)],2),e("li",{class:P({active:a.value=="fat"})},[e("button",{"data-name":"fat",onClick:h},l(n(t)("food.fat")),1)],2),e("li",{class:P({active:a.value=="carb"})},[e("button",{"data-name":"carb",onClick:h},l(n(t)("food.carbs2")),1)],2),e("li",{class:P({active:a.value=="prot"})},[e("button",{"data-name":"prot",onClick:h},l(n(t)("food.protein")),1)],2)],32)]),e("button",{class:"icon async",disabled:_.value,onClick:I[0]||(I[0]=(...O)=>L.onEditMode&&L.onEditMode(...O))},[p.value?V("",!0):(v(),B($e,{key:0})),p.value?(v(),B(_e,{key:1})):V("",!0)],8,no)]),lo,o.value?(v(),w("section",ao,[e("h2",null,l(n(t)("aria.headlog")),1),o.value.entries?V("",!0):(v(),w("p",{key:0,class:"msg-noitems",innerHTML:n(t)("diary.noitems")},null,8,oo)),g(Ya,{ref:"entries",entries:o.value.entries,disabled:!p.value},null,8,["entries","disabled"])])):V("",!0)]),_:1},512))}},io=e("hr",null,null,-1),uo=e("section",null,null,-1),co=D(" Shopping Lists "),ro={setup(i){const{t}=X(),u=U("diary"),c=y(null),o=G(()=>Object.keys(u.value));function s(a){console.log(a)}return(a,_)=>(v(),B(ae,{ref_key:"main",ref:c},{filter:z(()=>[e("section",null,[e("h2",null,l(n(t)("aria.headcal")),1),g(Me,{mode:"toggle",items:n(o),onSelection:s},null,8,["items"])]),io,uo]),main:z(()=>[co]),_:1},512))}},mo=D(" Profile "),vo={setup(i){return(t,u)=>(v(),B(ae,null,{main:z(()=>[mo]),_:1}))}},ho=D(" Settings "),_o={setup(i){return(t,u)=>(v(),B(ae,null,{main:z(()=>[ho]),_:1}))}},fo=ze({history:De(),routes:[{path:"/",name:"diary",component:so},{path:"/recipes",name:"recipes",component:Ca},{path:"/food",name:"food",component:Ll},{path:"/shopping",name:"shopping",component:ro},{path:"/profile",name:"profile",component:vo},{path:"/settings",name:"settings",component:_o}]});let he=document.documentElement.lang||navigator.language;!he&&navigator.languages!=null&&(he=navigator.languages[0]);Re.defaultLocale=he;const xe=document.querySelector("meta[name='_csrf']"),po=xe?xe.content:"",go=function(){const i=document.documentElement.dataset.perm||1,t=65536,u=131072;function c(o){return(i&o)==o}return{canCreateFood:c(t),canEditFood:c(u)}}(),bo=function(){function i(t){return typeof t=="string"?t:"message"in t?t.message:Z.global.t("err.err")}return{msg:function(t){let u={msg:i(t),timeout:3e3};window.dispatchEvent(new CustomEvent("message",{detail:u}))},warn:function(t){let u={msg:i(t),timeout:4e3};window.dispatchEvent(new CustomEvent("warning",{detail:u}))},err:function(t){let u={msg:i(t),timeout:5e3};window.dispatchEvent(new CustomEvent("error",{detail:u}))}}}(),Y=Oe(wt);let Z,ne,ue,le;function yo(i){Z=Ae({legacy:!1,locale:he.split("-")[0],fallbackLocale:"en",messages:i}),ne&&ue&&le&&fe()}function $o(i){ne=i,Z&&ue&&le&&fe()}function wo(i){ue=i,Z&&ne&&le&&fe()}function ko(i){le={},i.forEach(t=>le[t.date]=t),Z&&ne&&ue&&fe()}function fe(){ne.forEach(i=>{i.name=Z.global.t(i.id.toString())}),Y.provide("csrfToken",po),Y.provide("perms",go),Y.provide("food",y(ne)),Y.provide("recipes",y(ue)),Y.provide("diary",y(le)),Y.provide("log",bo),Y.use(fo),Y.use(Z),Y.mount("#app")}fetch("/app/l10n.json").then(i=>i.json()).then(yo);fetch("api/v1/foods").then(i=>i.json()).then($o);fetch("api/v1/recipes").then(i=>i.json()).then(wo);fetch("api/v1/diary").then(i=>i.json()).then(ko);
