import{o as m,c as x,a as e,u as U,i as X,b as _,w as M,d as E,t as l,e as n,R as J,f as se,g as N,h as B,n as P,r as p,F as ee,j as ie,k as Ee,l as ae,m as we,p as fe,q as Q,v as be,s as oe,x as pe,D as R,y as xe,z as Fe,A as Me,B as De,C as Re}from"./vendor.js";const Oe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const u of s)if(u.type==="childList")for(const a of u.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function i(s){const u={};return s.integrity&&(u.integrity=s.integrity),s.referrerpolicy&&(u.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?u.credentials="include":s.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(s){if(s.ep)return;s.ep=!0;const u=i(s);fetch(s.href,u)}};Oe();var j=(o,t)=>{const i=o.__vccOpts||o;for(const[r,s]of t)i[r]=s;return i};const Ae={},Ne={width:"512",height:"512",version:"1.1",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},Ve=e("path",{d:"m114.6 507.3c13.82-0.8729 90.06-3.083 106.2-3.079h13.49l2.639-5.293c5.191-10.41 10.35-29.57 13.13-48.74 1.811-12.5 1.488-16.68-1.826-23.56-2.528-5.249-11.04-13.06-20.54-18.86-28.38-17.32-51.21-34.77-76.05-58.12-6.673-6.272-9.377-8.209-16.08-11.53-12.37-6.124-20.36-12.88-29.19-24.7-1.45-1.941-1.795-2.038-4.695-1.334-1.722 0.4182-7.18 0.8166-12.13 0.8854-19.6 0.2722-38.18-7.715-52.49-22.56-15.97-16.57-23.43-35.49-23.41-59.37 0.01786-16.86 3.547-29.88 11.93-44 9.617-16.19 27.39-30.13 43.89-34.41 2.517-0.653 4.748-1.36 4.958-1.571 0.2103-0.2107-0.05169-3.078-0.5816-6.371-1.41-8.759-0.556-21.84 1.997-30.61 7.023-24.1 24.96-41.95 48.52-48.31 11.42-3.082 29.45-2.167 40.42 2.049 0.919 0.3533 1.637-0.7202 2.994-4.474 6.21-17.18 18.79-33.75 33.11-43.62 35.65-24.56 80.99-19.9 111.3 11.44l5.539 5.719 5.025-1.229c2.764-0.6762 9.075-1.428 14.02-1.672 16.17-0.7944 31.64 3.865 45.31 13.64l5.1 3.647 12.55 0.1171c9.984 0.09312 13.77 0.4491 18.49 1.739 29.1 7.945 50.37 32.58 56 64.86 1.354 7.764 1.096 21.6-0.5502 29.5l-0.916 4.394 5.367 7.086c20.1 26.54 25.52 61.05 14.68 93.52-7.862 23.55-24.99 43.53-46.38 54.11-10.16 5.023-23.1 8.587-31.28 8.613-3.79 0.0118-4.555 0.333-8.217 3.446-6.958 5.916-20.59 13.71-28.3 16.17-1.722 0.551-4.011 1.599-5.087 2.328-1.076 0.7297-8.119 4.802-15.65 9.05-18.57 10.47-37.53 22.69-48.72 31.39-13.27 10.32-16.83 22.63-14.72 50.94 2.648 35.64 8.059 59.41 16.33 71.75l2.89 4.313 29.4 0.4963c34.14 0.5764 92.53 2.291 93.01 2.731 0.1793 0.166-74.3 0.2503-165.5 0.1877-91.21-0.0631-161.4-0.392-156-0.732zm130.9-101.8c-0.1092-1.007-3.147-5.947-6.75-10.98-7.889-11.01-19.71-28.99-22.37-34.01-1.594-3.014-2.402-3.727-4.695-4.139-7.259-1.304-17.91-5.324-27.58-10.41-1.809-0.9509 5.669 20.15 9.032 25.49 4.859 7.714 27.69 24.94 45.08 34 5.177 2.7 7.575 2.715 7.285 0.0442zm6.168-19.46c0.8235-0.9976 1.074-4.638 1.074-15.62 0-7.875-0.1764-14.5-0.3923-14.71-0.2158-0.2163-2.307 0.1044-4.647 0.7128-2.34 0.6082-7 1.335-10.35 1.616-7.067 0.5907-6.896 0-2.984 10.28 2.73 7.17 6.328 12.81 10.4 16.3 3.513 3.013 5.293 3.38 6.908 1.424zm49.91-15.13c3.913-2 11.37-9.412 15.96-15.85 3.982-5.592 8.688-15 8.214-16.42-0.1628-0.49-3.275-1.75-6.916-2.799-3.641-1.049-9.568-3.501-13.17-5.449l-6.551-3.541-2.173 2.087c-2.148 2.062-2.179 2.234-2.645 14.37-0.2592 6.754-0.6282 15.17-0.8198 18.7-0.3026 5.572-0.1405 6.682 1.232 8.43 1.896 2.415 2.946 2.489 6.867 0.484zm-118.1-5.725c-2.19-4.729-6.256-17.66-6.256-19.89 0-0.8683-1.901-1.089-9.391-1.089-5.165 0-9.391 0.2195-9.391 0.488 0 1.561 25.33 25.39 26.99 25.39 0.1762 0-0.7011-2.206-1.949-4.901zm149.8-9.536c5.487-3.687 19.46-14.65 19.07-14.96-0.126-0.1032-4.197-0.3888-9.046-0.6338l-8.816-0.4452-3.967 5.891c-4.284 6.363-7.088 11.99-6.473 12.98 0.9066 1.47 4.434 0.3864 9.228-2.836z",fill:"#13ad73"},null,-1),Pe=e("path",{d:"m253.9 167.7c-0.2579 0.0513-1.238 0.5454-4.691 0.5216-3.625-0.0248 4.941 9.227 6.934 34.4-8.031-0.4678-8.408-3.285-24.81-5.999-15.88-2.627-25.28 5.883-29.57 18.88-3.429 10.39-3.592 23.66-1.19 36.39 2.348 12.45 7.148 24.39 13.74 32.65 6.909 8.654 14.05 10.96 20.49 10.82 8.459-0.1842 15.7-4.599 19.58-4.407 6.726 0.3331 13.29 8.894 28.17 2.151 6.047-2.741 12.03-7.819 17.08-14.81 4.984-6.907 9.051-15.68 11.35-25.91 2.018-8.972 2.678-19.07 1.41-30-1.616-13.93-7.519-20.42-14.9-23.01-8.286-2.905-18.43-0.8896-26.46 1.032-4.71 1.127-8.69 2.223-11.14 2.273-0.155 3e-3 -0.2829-4.1e-4 -0.4335 2e-3 -0.01-0.0695-0.0197-0.1385-0.0323-0.2078-2.249-11.58-4.704-29.29-5.401-33.64-0.152-0.9486 0.0845-1.177-0.1162-1.137z",fill:"#f2ac05","fill-rule":"evenodd"},null,-1),Be=[Ve,Pe];function Ue(o,t){return m(),x("svg",Ne,Be)}var je=j(Ae,[["render",Ue]]);const Xe={},qe={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},He=e("path",{d:"m12 0c-6.624 0-12 5.376-12 12s5.376 12 12 12 12-5.376 12-12-5.376-12-12-12zm0 3.6c1.992 0 3.6 1.608 3.6 3.6s-1.608 3.6-3.6 3.6-3.6-1.608-3.6-3.6 1.608-3.6 3.6-3.6zm0 17.04c-3 0-5.652-1.536-7.2-3.864 0.036-2.388 4.8-3.696 7.2-3.696 2.388 0 7.164 1.308 7.2 3.696-1.548 2.328-4.2 3.864-7.2 3.864z"},null,-1),We=[He];function Ke(o,t){return m(),x("svg",qe,We)}var Ge=j(Xe,[["render",Ke]]);const Je={},Qe={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ye=e("path",{d:"m12 0-2.115 2.115 8.37 8.385h-18.255v3h18.255l-8.37 8.385 2.115 2.115 12-12z"},null,-1),Ze=[Ye];function et(o,t){return m(),x("svg",Qe,Ze)}var _e=j(Je,[["render",et]]);const tt=e("div",{id:"app-name"},[e("span",null,"Hey"),e("span",null,"Apple")],-1),nt={id:"nav-main"},lt={id:"nav-user"},at={href:"https://docs.heyapple.org",target:"_blank"},ot={setup(o){const{t}=U(),i=X("csrfToken");function r(u){u.preventDefault(),fetch("/auth/local",{method:"DELETE",headers:{"X-CSRF-Token":i}}).then(a=>{a.ok?window.location="/":window.dispatchEvent(new CustomEvent("error",{detail:{msg:t("signout.err"+a.status)}}))})}function s(u){u.stopPropagation(),document.querySelector("header nav").classList.toggle("open")}return document.addEventListener("click",function(){document.querySelector("header nav").classList.remove("open")}),(u,a)=>(m(),x("header",null,[_(je,{id:"logo"}),tt,e("nav",null,[e("button",{onClick:s},[_(_e)]),e("ul",nt,[e("li",null,[_(n(J),{to:"/"},{default:M(()=>[E(l(n(t)("nav.diary")),1)]),_:1})]),e("li",null,[_(n(J),{to:"/food"},{default:M(()=>[E(l(n(t)("nav.food")),1)]),_:1})]),e("li",null,[_(n(J),{to:"/recipes"},{default:M(()=>[E(l(n(t)("nav.recipes")),1)]),_:1})]),e("li",null,[_(n(J),{to:"/shopping"},{default:M(()=>[E(l(n(t)("nav.shopping")),1)]),_:1})])]),e("ul",lt,[e("li",null,[_(n(J),{to:"/profile"},{default:M(()=>[E(l(n(t)("nav.profile")),1)]),_:1})]),e("li",null,[_(n(J),{to:"/settings"},{default:M(()=>[E(l(n(t)("nav.settings")),1)]),_:1})]),e("li",null,[e("a",at,l(n(t)("nav.help")),1)]),e("li",null,[e("a",{href:"#",onClick:r},l(n(t)("nav.signout")),1)])])]),e("button",{onClick:s},[_(Ge)])]))}},st={},it={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},ut=e("path",{d:"m7.6364 17.318-5.7273-5.7273-1.9091 1.9091 7.6364 7.6364 16.364-16.364-1.9091-1.9091z"},null,-1),ct=[ut];function rt(o,t){return m(),x("svg",it,ct)}var ye=j(st,[["render",rt]]);const dt={},mt={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},_t=e("path",{d:"m12 1.6364-12 20.727h24zm0 4.353 8.2159 14.192h-16.43zm-1.0909 4.3743v5.4545h2.1818v-5.4545zm0 6.5455v2.1818h2.1818v-2.1818z"},null,-1),vt=[_t];function ht(o,t){return m(),x("svg",mt,vt)}var ft=j(dt,[["render",ht]]);const pt={props:["msg"],emits:["timeout"],setup(o,{emit:t}){const i=o;return se(()=>{setTimeout(function(){t("timeout",i.msg.id)},i.msg.time)}),(r,s)=>(m(),x("div",{class:P(["message",[o.msg.type,o.msg.id]])},[o.msg.type=="message"?(m(),N(ye,{key:0})):B("",!0),o.msg.type!="message"?(m(),N(ft,{key:1})):B("",!0),e("p",null,l(o.msg.msg),1)],2))}};const gt={id:"messages"},bt={setup(o){const t=p([]);let i=0;function r(u){t.value.push({id:i++,type:u.type,msg:u.detail.msg,time:u.detail.timeout})}function s(u){t.value=t.value.filter(a=>a.id!=u)}return se(()=>{window.addEventListener("message",r),window.addEventListener("warning",r),window.addEventListener("error",r)}),(u,a)=>(m(),x("div",gt,[(m(!0),x(ee,null,ie(t.value,d=>(m(),N(pt,{key:d.id,msg:d,onTimeout:s},null,8,["msg"]))),128))]))}};const yt={setup(o){return se(()=>{document.querySelector("body > .spinner-container").remove()}),(t,i)=>(m(),x(ee,null,[_(ot),_(n(Ee)),_(bt)],64))}},$t={},wt={version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},kt=e("path",{id:"path-top",d:"m0 3v2h24v-2z"},null,-1),xt=e("path",{id:"path-mid",d:"m0 13h24v-2h-24z"},null,-1),Ct=e("path",{id:"path-bottom",d:"m0 21h24v-2h-24z"},null,-1),It=[kt,xt,Ct];function St(o,t){return m(),x("svg",wt,It)}var Lt=j($t,[["render",St]]);const Tt={},zt={width:"512",height:"512",version:"1.1",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},Et=e("path",{d:"m251.2 4.007c-17.24-0.2277-34.69 4.924-50.29 15.67-14.33 9.866-26.9 26.43-33.11 43.62-1.357 3.754-2.073 4.828-2.992 4.475-10.97-4.217-29-5.131-40.42-2.049-23.57 6.359-41.5 24.22-48.52 48.31-2.553 8.761-3.407 21.84-1.997 30.6 0.5299 3.293 0.7902 6.162 0.5799 6.372-0.2104 0.2108-2.439 0.9186-4.956 1.572-16.5 4.283-34.28 18.21-43.89 34.41-8.382 14.11-11.91 27.14-11.93 44-0.02401 23.88 7.433 42.79 23.41 59.36 14.31 14.85 32.89 22.84 52.49 22.56 4.95-0.0689 10.41-0.4681 12.13-0.8863 2.9-0.7045 3.245-0.6061 4.695 1.334 8.833 11.82 16.82 18.58 29.19 24.7 6.707 3.32 9.412 5.257 16.09 11.53 24.85 23.35 47.68 40.8 76.05 58.12 9.503 5.8 18.01 13.61 20.54 18.86 3.313 6.878 3.637 11.06 1.825 23.56-2.778 19.18-7.936 38.33-13.13 48.74l-2.639 5.295h-13.49c-16.17-3e-3 -92.41 2.205-106.2 3.077l0.01-3e-3c-5.381 0.3399 64.84 0.6684 156 0.7315 91.2 0.0625 165.7-0.0216 165.5-0.1878-0.4753-0.4399-58.86-2.155-93-2.731l-29.4-0.4942-2.89-4.313c-8.274-12.35-13.68-36.12-16.33-71.76-2.105-28.31 1.454-40.62 14.72-50.94 11.18-8.699 30.14-20.92 48.72-31.39 7.533-4.248 14.57-8.318 15.65-9.048 1.076-0.7296 3.366-1.779 5.087-2.33 7.71-2.467 21.34-10.26 28.3-16.17 3.662-3.113 4.427-3.435 8.218-3.446 8.183-0.0267 21.12-3.59 31.28-8.613 21.39-10.58 38.52-30.56 46.38-54.11 10.84-32.47 5.42-66.98-14.68-93.52l-5.364-7.084 0.916-4.395c1.646-7.896 1.904-21.74 0.5502-29.5-5.632-32.29-26.9-56.92-56-64.86-4.726-1.29-8.51-1.647-18.49-1.74l-12.55-0.1186-5.101-3.647c-13.67-9.776-29.15-14.43-45.31-13.64-4.95 0.2432-11.26 0.9944-14.02 1.671l-5.028 1.229-5.539-5.72c-17.07-17.63-38.89-26.81-61.05-27.1zm2.728 163.7c0.2008-0.0398-0.0367 0.1881 0.1154 1.137 0.6972 4.35 3.151 22.06 5.4 33.64 0.0118 0.0694 0.0228 0.138 0.0328 0.2076 0.1506-2e-3 0.2799 9e-5 0.4349-3e-3 2.448-0.0501 6.427-1.143 11.14-2.27 8.028-1.922 18.18-3.94 26.46-1.035 7.379 2.587 13.28 9.078 14.9 23.01 1.268 10.94 0.6106 21.03-1.407 30-2.301 10.23-6.37 19.01-11.35 25.91-5.045 6.991-11.03 12.07-17.07 14.81-14.87 6.743-21.44-1.818-28.16-2.152-3.88-0.1922-11.12 4.224-19.58 4.409-6.437 0.1402-13.58-2.169-20.49-10.82-6.596-8.262-11.39-20.2-13.74-32.65-2.402-12.73-2.24-26 1.189-36.39 4.29-13 13.69-21.51 29.58-18.88 16.41 2.714 16.78 5.532 24.81 6-1.993-25.18-10.56-34.43-6.936-34.4 3.453 0.0238 4.434-0.4726 4.692-0.5239zm45.16 159.1 6.55 3.542c3.603 1.947 9.529 4.401 13.17 5.45 3.641 1.049 6.753 2.307 6.916 2.797 0.4733 1.423-4.232 10.83-8.214 16.42-4.588 6.442-12.05 13.85-15.96 15.86-3.919 2.004-4.971 1.93-6.867-0.4843-1.372-1.748-1.532-2.86-1.229-8.432 0.1916-3.529 0.558-11.94 0.8171-18.7 0.4657-12.13 0.4983-12.3 2.646-14.37zm35.38 12.77 8.817 0.4448c4.849 0.245 8.919 0.5294 9.045 0.6326 0.3835 0.315-13.58 11.27-19.07 14.96-4.795 3.222-8.322 4.307-9.229 2.837-0.6151-0.9971 2.187-6.619 6.471-12.98zm-166.7 4.596c7.489 0 9.391 0.219 9.391 1.087 0 2.234 4.067 15.16 6.257 19.89 1.248 2.694 2.123 4.9 1.947 4.9-1.66 0-26.99-23.83-26.99-25.39 0-0.2685 4.226-0.4876 9.391-0.4876zm16.13 1.727c0.0388-0.0118 0.0851-6e-3 0.1417 0.0231 9.674 5.087 20.32 9.107 27.58 10.41 2.293 0.4121 3.101 1.124 4.695 4.138 2.657 5.026 14.48 23 22.37 34.02 3.603 5.03 6.639 9.968 6.748 10.98 0.2897 2.671-2.108 2.658-7.285-0.0429-17.39-9.068-40.22-26.29-45.07-34.01-3.258-5.172-10.38-25.14-9.173-25.52zm67.9 9.71c0.263-9e-3 0.4337 9e-3 0.4876 0.0625 0.2159 0.2154 0.3921 6.837 0.3921 14.71 0 10.98-0.2506 14.62-1.074 15.62-1.615 1.956-3.397 1.59-6.909-1.423-4.068-3.49-7.665-9.13-10.4-16.3-3.912-10.28-4.082-9.686 2.985-10.28 3.355-0.2804 8.013-1.006 10.35-1.615 1.755-0.4562 3.373-0.7502 4.162-0.7776z"},null,-1),Ft=[Et];function Mt(o,t){return m(),x("svg",zt,Ft)}var Dt=j(Tt,[["render",Mt]]);const Rt={},Ot={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},At=e("path",{d:"m12 6c1.65 0 3-1.35 3-3s-1.35-3-3-3-3 1.35-3 3 1.35 3 3 3zm0 3c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3zm0 9c-1.65 0-3 1.35-3 3s1.35 3 3 3 3-1.35 3-3-1.35-3-3-3z"},null,-1),Nt=[At];function Vt(o,t){return m(),x("svg",Ot,Nt)}var Pt=j(Rt,[["render",Vt]]);const Bt={id:"filter"},Ut=E(" This is the main search & filter area"),jt={id:"main"},Xt={class:"controls"},qt=e("span",{class:"spacer"},null,-1),Ht={class:"content"},Wt=E("This is the main area"),Kt={id:"details"},Gt={class:"controls"},Jt=e("span",{class:"spacer"},null,-1),Qt={class:"placeholder"},te={emits:["detailVisibility"],setup(o,{expose:t,emit:i}){const{t:r}=U(),s=p(""),u=p("");function a(){s.value==""?(s.value="open-filter",u.value="",i("detailVisibility")):s.value=""}function d(){i("detailVisibility"),u.value==""?(u.value="open-details",s.value=""):u.value=""}function h(){i("detailVisibility"),u.value==""&&(u.value="open-details",s.value="")}return t({showDetails:h}),(y,I)=>(m(),x("main",{class:P([s.value,u.value])},[e("div",Bt,[ae(y.$slots,"filter",{},()=>[Ut])]),e("div",jt,[e("div",Xt,[e("button",{onClick:a,class:"open-filter icon"},[_(Lt)]),qt,e("button",{onClick:d,class:"open-details icon"},[_(Pt)])]),e("div",Ht,[ae(y.$slots,"main",{},()=>[Wt])])]),e("div",Kt,[e("div",Gt,[ae(y.$slots,"head-details"),Jt,e("button",{onClick:d,class:"open-details icon"},[_(_e)])]),ae(y.$slots,"details",{},()=>[e("div",Qt,[_(Dt),e("p",null,l(n(r)("details.noitem")),1)])])])],2))}},Yt=["placeholder"],Zt=E("Additional filters"),Ce={props:["data","placeholder"],emits:["result"],setup(o,{emit:t}){const i=o;var r=void 0;function s(a){a.preventDefault(),clearTimeout(r),r=setTimeout(function(){u(a.target.closest("form"))},500)}function u(a){let d=new FormData(a),h=i.data.filter(y=>{let I=y.size||1;for(let f of d.keys()){if(f=="name"){let z=d.get(f).toLowerCase();if(!y[f].toLowerCase().includes(z))return!1;continue}let[g,b]=d.getAll(f).map(z=>parseFloat(z));if(!isNaN(g)&&!isNaN(b)&&(y[f]/I<g||b<y[f]/I))return!1}return!0});t("result",h)}return(a,d)=>(m(),x("form",null,[e("input",{type:"text",name:"name",placeholder:o.placeholder,onInput:s},null,40,Yt),ae(a.$slots,"default",{confirm:s},()=>[Zt])]))}};const en={class:"slider"},tn=["name","value"],nn=E(" \xA0\u2013\xA0 "),ln=["name","value"],an={class:"bar"},on={class:"slide"},sn=e("div",{class:"interact-area"},null,-1),un=[sn],cn=e("div",{class:"interact-area"},null,-1),rn=[cn],A={props:["label","name","unit","min","max","frac"],emits:["input"],setup(o,{emit:t}){const i=o,{t:r}=U(),s=p(parseFloat(i.min).toFixed(i.frac)),u=p(parseFloat(i.max).toFixed(i.frac)),a=p(0),d=p(100);we(()=>i.min,(c,w)=>h(c)),we(()=>i.max,(c,w)=>y(c));function h(c){let w=parseFloat(i.min)||0,k=parseFloat(c)||w;s.value=k,u.value=Math.max(s.value,u.value);let $=parseFloat(i.max)||0;a.value=(k-w)*100/($-w),d.value=Math.max(a.value,d.value)}function y(c){let w=parseFloat(i.max)||0,k=parseFloat(c)||w;u.value=k,s.value=Math.min(s.value,u.value);let $=parseFloat(i.min)||0;d.value=(k-$)*100/(w-$),a.value=Math.min(a.value,d.value)}function I(c){c.target.blur(),h(c.target.value),t("input",c)}function f(c){c.target.blur(),y(c.target.value),t("input",c)}function g(c){let k=c.target.closest(".slide").getBoundingClientRect(),$=c.pageX!==void 0?c.pageX:c.changedTouches[0].pageX;$=Math.min(Math.max($-k.left,0),k.width);let O=$*100/k.width,K=parseFloat(i.min)||0,ne=parseFloat(i.max)||0,G=O/100*(ne-K)+K;c.target.closest("button").classList.contains("min")?(s.value=G.toFixed(i.frac),u.value=Math.max(s.value,u.value),a.value=O,d.value=Math.max(a.value,d.value)):(u.value=G.toFixed(i.frac),s.value=Math.min(s.value,u.value),d.value=O,a.value=Math.min(a.value,d.value)),t("input",c)}function b(c){let w=c.target.closest("button");w.addEventListener("mousemove",g),w.addEventListener("touchmove",g),w.addEventListener("mouseup",z),w.addEventListener("touchend",z),w.addEventListener("mouseleave",z),w.addEventListener("touchcancel",z),w.classList.add("active")}function z(c){let w=c.target.closest("button");w.removeEventListener("mousemove",g),w.removeEventListener("touchmove",g),w.removeEventListener("mouseup",z),w.removeEventListener("touchend",z),w.removeEventListener("mouseleave",z),w.removeEventListener("touchcancel",z),w.classList.remove("active")}return(c,w)=>(m(),x("div",en,[e("label",null,[e("span",null,l(o.label)+" ("+l(n(r)("unit."+o.unit))+")",1),e("input",{type:"text",name:o.name,value:s.value,onChange:I},null,40,tn),nn,e("input",{type:"text",name:o.name,value:u.value,onChange:f},null,40,ln)]),e("div",an,[e("div",on,[e("div",{class:"overlay",style:fe({left:a.value+"%",right:100-d.value+"%"})},null,4),e("button",{type:"button",class:"handle min",style:fe({left:a.value+"%"}),onMousedown:b,onTouchstart:b},un,36),e("button",{type:"button",class:"handle max",style:fe({left:d.value+"%"}),onMousedown:b,onTouchstart:b},rn,36)])])]))}};const dn={class:"clickable-input"},mn=["placeholder"],_n=["value"],Ie={props:["label","placeholder"],emits:["confirm"],setup(o,{emit:t}){const i=p("");function r(s){s.preventDefault(),t("confirm",i.value),i.value=""}return(s,u)=>(m(),x("form",dn,[Q(e("input",{type:"text","onUpdate:modelValue":u[0]||(u[0]=a=>i.value=a),placeholder:o.placeholder},null,8,mn),[[be,i.value]]),e("input",{type:"submit",onClick:r,value:o.label},null,8,_n)]))}};const vn={class:"clickable-select"},hn={value:"0",selected:""},fn=["value"],pn=["disabled"],gn={props:["label","placeholder","items","disabled"],emits:["confirm"],setup(o,{emit:t}){const i=o,{locale:r}=U(),s=p(0),u=new Intl.Collator(r.value,{numeric:!0}),a=oe(()=>[...i.items].sort((h,y)=>u.compare(h.name,y.name)));function d(h){h.preventDefault(),s.value&&t("confirm",s.value)}return(h,y)=>(m(),x("form",vn,[Q(e("select",{"onUpdate:modelValue":y[0]||(y[0]=I=>s.value=I)},[e("option",hn,l(o.placeholder),1),(m(!0),x(ee,null,ie(n(a),I=>(m(),x("option",{key:I.id,value:I.id},l(I.name),9,fn))),128))],512),[[pe,s.value]]),e("button",{type:"submit",class:"async",onClick:d,disabled:o.disabled},l(o.label),9,pn)]))}};const bn={class:"clickable-date"},yn=["value"],$n=["value"],wn=["disabled"],Se={props:["label","date","time","disabled"],emits:["confirm"],setup(o,{emit:t}){function i(r){r.preventDefault();let s=new FormData(r.target.closest("form"));t("confirm",s.get("date"),s.get("time"))}return(r,s)=>(m(),x("form",bn,[e("input",{type:"date",name:"date",value:o.date},null,8,yn),e("input",{type:"time",name:"time",value:o.time},null,8,$n),e("button",{type:"submit",class:"async",onClick:i,disabled:o.disabled},l(o.label),9,wn)]))}};const kn={},xn={class:"icon sort-arrow"};function Cn(o,t){return m(),x("span",xn)}var le=j(kn,[["render",Cn]]);const In=["onClick"],Sn={class:"name"},Ln={class:"num"},Tn={class:"unit"},zn={class:"m num"},En={class:"unit"},Fn={class:"m num"},Mn={class:"unit"},Dn={class:"m num"},Rn={class:"unit"},Le={props:["items"],emits:"selected",setup(o,{emit:t}){const i=o,{t:r,locale:s}=U(),u=p("name"),a=p("asc"),d=new Intl.Collator(s.value,{numeric:!0}),h=oe(()=>a.value=="asc"?[...i.items].sort((f,g)=>d.compare(f[u.value],g[u.value])):[...i.items].sort((f,g)=>-d.compare(f[u.value],g[u.value])));function y(f,g,b=1){return g?+parseFloat(f/g).toFixed(b):f}function I(f){let g=f.target.dataset.sort;u.value==g?a.value=a.value=="asc"?"desc":"asc":u.value=g}return(f,g)=>(m(),x("table",null,[e("thead",null,[e("tr",{class:P(a.value)},[e("th",{class:P(["name sort",{active:u.value=="name"}]),onClick:I,"data-sort":"name"},[E(l(n(r)("food.name"))+" ",1),_(le)],2),e("th",{class:P(["num sort",{active:u.value=="kcal"}]),onClick:I,"data-sort":"kcal"},[_(le),E(" "+l(n(r)("food.energy")),1)],2),e("th",{class:P(["m num sort",{active:u.value=="fat"}]),onClick:I,"data-sort":"fat"},[_(le),E(" "+l(n(r)("food.fat")),1)],2),e("th",{class:P(["m num sort",{active:u.value=="carb"}]),onClick:I,"data-sort":"carb"},[_(le),E(" "+l(n(r)("food.carbs2")),1)],2),e("th",{class:P(["m num sort",{active:u.value=="prot"}]),onClick:I,"data-sort":"prot"},[_(le),E(" "+l(n(r)("food.protein")),1)],2)],2)]),e("tbody",null,[(m(!0),x(ee,null,ie(n(h),b=>(m(),x("tr",{key:b.id,onClick:z=>f.$emit("selected",b.id)},[e("td",Sn,l(b.name),1),e("td",Ln,[E(l(y(b.kcal,b.size))+" ",1),e("span",Tn,l(n(r)("unit.cal")),1)]),e("td",zn,[E(l(y(b.fat,b.size))+" ",1),e("span",En,l(n(r)("unit.g")),1)]),e("td",Fn,[E(l(y(b.carb,b.size))+" ",1),e("span",Mn,l(n(r)("unit.g")),1)]),e("td",Dn,[E(l(y(b.prot,b.size))+" ",1),e("span",Rn,l(n(r)("unit.g")),1)])],8,In))),128))])]))}},On={},An={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Nn=e("path",{d:"m-7.5e-8 19.001v4.9993h4.9993l14.745-14.745-4.9993-4.9993zm23.61-13.611c0.51993-0.51993 0.51993-1.3598 0-1.8797l-3.1196-3.1196c-0.51993-0.51993-1.3598-0.51993-1.8797 0l-2.4397 2.4397 4.9993 4.9993z"},null,-1),Vn=[Nn];function Pn(o,t){return m(),x("svg",An,Vn)}var Te=j(On,[["render",Pn]]);const Bn={key:0,class:"new-item"},Un=e("hr",null,null,-1),jn=e("section",{class:"subtitle"},"Some food category",-1),Xn={class:"tags"},qn=e("span",{class:"tag"},"Tag 1",-1),Hn=e("span",{class:"tag"},"Tag 2",-1),Wn=e("span",{class:"tag"},"Tag 3",-1),Kn=["disabled"],Gn=e("hr",null,null,-1),Jn={class:"tracking no-edit-mode"},Qn={class:"tracking-amount"},Yn={class:"unit"},Zn=e("label",null,"Add to recipe",-1),el=e("label",null,"Add to diary",-1),tl=e("hr",null,null,-1),nl={class:"nutrient-block"},ll=["disabled"],al=["value"],ol={class:"unit"},sl=["value"],il={class:"unit"},ul=["value"],cl={class:"unit"},rl=["value"],dl={class:"unit"},ml=["value"],_l={class:"unit"},vl=["disabled"],hl=["value"],fl={class:"unit"},pl=["value"],gl={class:"unit"},bl=["value"],yl={class:"unit"},$l=["value"],wl={class:"unit"},kl=["value"],xl={class:"unit"},Cl={setup(o){const{t}=U(),i=X("log"),r=X("csrfToken"),s=X("perms"),u=X("food"),a=X("recipes"),d=p([]),h=p(null),y=p(!1),I=p(!1),f=p(!1),g=p(!1),b=p(100),z=p(R.now().toISODate()),c=p(R.now().toLocaleString(R.TIME_24_SIMPLE)),w=p(null),k=p(null);function $(F){fetch("/api/v1/food",{method:"POST",headers:{"X-CSRF-Token":r}}).then(v=>{if(!v.ok)throw t("createfood.err"+v.status);return v.json()}).then(v=>{v.name=F,u.value.push(v),d.value.push(v),i.msg(t("createfood.ok")),ce(v.id)}).catch(v=>i.err(v))}function O(){I.value=!0;let F=h.value.id;fetch("/api/v1/food/"+F,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams(new FormData(k.value))}).then(v=>{if(!v.ok)throw t("savefood.err"+v.status);return y.value=!1,fetch("/api/v1/food/"+F)}).then(v=>v.json()).then(v=>{v.name=t(v.id.toString()),u.value=u.value.map(L=>v.id==L.id?v:L),d.value=d.value.map(L=>v.id==L.id?v:L),h.value=h.value.id==v.id?v:h.value,i.msg(t("savefood.ok"))}).catch(v=>i.err(v)).finally(()=>{setTimeout(function(){I.value=!1},500)})}function K(F){f.value=!0,fetch(`/api/v1/recipe/${F}/ingredient/${h.value.id}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({amount:b.value})}).then(v=>{if(!v.ok)throw t("addfood.err"+v.status);return fetch("/api/v1/recipe/"+F)}).then(v=>v.json()).then(v=>{a.value=a.value.map(L=>v.id==L.id?v:L),b.value=100,i.msg(t("addfood.ok"))}).catch(v=>i.err(v)).finally(()=>{setTimeout(function(){f.value=!1},500)})}function ne(F,v){g.value=!0,fetch(`/api/v1/diary/${F}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({id:h.value.id,amount:b.value,time:v})}).then(L=>{if(!L.ok)throw t("adddiary.err"+L.status);b.value=100,i.msg(t("adddiary.ok"))}).catch(L=>i.err(L)).finally(()=>{setTimeout(function(){g.value=!1},500)})}function G(F){d.value=F,h.value&&d.value.filter(v=>v.id==h.value.id).length==0&&(h.value=null)}function ce(F){h.value=d.value.filter(v=>v.id==F)[0],z.value=R.now().toISODate(),c.value=R.now().toLocaleString(R.TIME_24_SIMPLE),b.value=100,w.value.showDetails()}function re(){y.value?O():y.value=!0}function V(F){F.target.blur(),isNaN(parseFloat(F.target.value))&&(F.target.value=h.value[F.target.name])}return(F,v)=>(m(),N(te,{ref_key:"main",ref:w,onDetailVisibility:v[1]||(v[1]=L=>y.value=!1),class:P({"edit-mode":y.value})},xe({filter:M(()=>[n(s).canCreateFood?(m(),x("section",Bn,[e("h2",null,l(n(t)("aria.headnew")),1),_(Ie,{label:n(t)("btn.new"),placeholder:n(t)("food.hintnew"),onConfirm:$},null,8,["label","placeholder"])])):B("",!0),Un,e("section",null,[e("h2",null,l(n(t)("aria.headsearch")),1),_(Ce,{data:n(u),placeholder:n(t)("food.hintsearch"),onResult:G},{default:M(L=>[e("fieldset",null,[e("legend",null,l(n(t)("aria.headmacro1")),1),_(A,{label:n(t)("food.energy"),onInput:L.confirm,name:"kcal",unit:"cal",min:"0",max:"900",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.fat"),onInput:L.confirm,name:"fat",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.carbs"),onInput:L.confirm,name:"carb",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.protein"),onInput:L.confirm,name:"prot",unit:"g",min:"0",max:"89",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.fiber"),onInput:L.confirm,name:"fib",unit:"g",min:"0",max:"71",frac:"0"},null,8,["label","onInput"])]),e("fieldset",null,[e("legend",null,l(n(t)("aria.headmacro2")),1),_(A,{label:n(t)("food.fatsat"),onInput:L.confirm,name:"fatsat",unit:"g",min:"0",max:"83",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.fato3"),onInput:L.confirm,name:"fato3",unit:"g",min:"0",max:"54",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.fato6"),onInput:L.confirm,name:"fato6",unit:"g",min:"0",max:"70",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.sugar"),onInput:L.confirm,name:"sug",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"]),_(A,{label:n(t)("food.salt"),onInput:L.confirm,name:"salt",unit:"g",min:"0",max:"100",frac:"0"},null,8,["label","onInput"])])]),_:1},8,["data","placeholder"])])]),main:M(()=>[_(Le,{items:d.value,onSelected:ce},null,8,["items"])]),_:2},[h.value?{name:"head-details",fn:M(()=>[e("h2",null,l(h.value.name),1)])}:void 0,h.value?{name:"details",fn:M(()=>[jn,e("section",Xn,[qn,Hn,Wn,n(s).canCreateFood||n(s).canEditFood?(m(),x("button",{key:0,class:"icon async",disabled:I.value,onClick:re},[y.value?B("",!0):(m(),N(Te,{key:0})),y.value?(m(),N(ye,{key:1})):B("",!0)],8,Kn)):B("",!0)]),Gn,e("section",Jn,[e("h2",null,l(n(t)("aria.headtrack")),1),e("fieldset",Qn,[e("div",null,[e("label",null,l(n(t)("food.amount")),1),Q(e("input",{type:"number","onUpdate:modelValue":v[0]||(v[0]=L=>b.value=L),name:"amount"},null,512),[[be,b.value]]),e("span",Yn,l(n(t)("unit.g")),1)])]),e("fieldset",null,[Zn,_(gn,{label:n(t)("btn.add"),placeholder:n(t)("food.hintrec"),items:n(a),disabled:f.value,onConfirm:K},null,8,["label","placeholder","items","disabled"])]),e("fieldset",null,[el,_(Se,{label:n(t)("btn.add"),time:c.value,date:z.value,disabled:g.value,onConfirm:ne},null,8,["label","time","date","disabled"])])]),tl,e("section",null,[e("h2",null,l(n(t)("aria.headnutrients")),1),e("form",{ref_key:"form",ref:k},[e("div",nl,[e("fieldset",{disabled:!y.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("food.energy")),1),e("input",{type:"text",value:h.value.kcal,name:"kcal",onChange:V},null,40,al),e("span",ol,l(n(t)("unit.cal")),1)]),e("div",null,[e("label",null,l(n(t)("food.fat")),1),e("input",{type:"text",value:h.value.fat,name:"fat",onChange:V},null,40,sl),e("span",il,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.carbs2")),1),e("input",{type:"text",value:h.value.carb,name:"carb",onChange:V},null,40,ul),e("span",cl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.protein")),1),e("input",{type:"text",value:h.value.prot,name:"prot",onChange:V},null,40,rl),e("span",dl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fiber")),1),e("input",{type:"text",value:h.value.fib,name:"fib",onChange:V},null,40,ml),e("span",_l,l(n(t)("unit.g")),1)])],8,ll),e("fieldset",{disabled:!y.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("food.fatsat")),1),e("input",{type:"text",value:h.value.fatsat,name:"fatsat",onChange:V},null,40,hl),e("span",fl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fato3")),1),e("input",{type:"text",value:h.value.fato3,name:"fato3",onChange:V},null,40,pl),e("span",gl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.fato6")),1),e("input",{type:"text",value:h.value.fato6,name:"fato6",onChange:V},null,40,bl),e("span",yl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.sugar")),1),e("input",{type:"text",value:h.value.sug,name:"sug",onChange:V},null,40,$l),e("span",wl,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.salt")),1),e("input",{type:"text",value:h.value.salt,name:"salt",onChange:V},null,40,kl),e("span",xl,l(n(t)("unit.g")),1)])],8,vl)])],512)])])}:void 0]),1032,["class"]))}};const Il=["disabled"],Sl=["value"],Ll={class:"unit"},Tl=["value"],zl={props:["items","disabled"],setup(o,{expose:t}){const i=o,{t:r,locale:s}=U(),u=p("name"),a=p(null),d=new Intl.Collator(s.value,{numeric:!0}),h=oe(()=>i.items.map(g=>({id:g.id,amount:g.amount,name:r(g.id.toString())})).sort((g,b)=>d.compare(g[u.value],b[u.value])));function y(f){f.target.blur();let g=parseFloat(f.target.value);(isNaN(g)||g<0)&&(f.target.value=0)}function I(){let f=new FormData(a.value),g=f.getAll("id"),b=f.getAll("amount"),z=[];return i.items.forEach(c=>{let w=parseInt(g.indexOf(c.id.toString())),k=parseFloat(b[w]);k!=c.amount&&z.push({id:c.id,amount:k})}),z}return t({getDiff:I}),(f,g)=>(m(),x("form",{class:"ingredients",ref_key:"form",ref:a},[e("fieldset",{disabled:o.disabled},[(m(!0),x(ee,null,ie(n(h),b=>(m(),x("div",{key:b.id},[e("label",null,l(b.name),1),e("input",{type:"number",name:"amount",value:b.amount,onChange:y},null,40,Sl),e("span",Ll,l(n(r)("unit.g")),1),e("input",{type:"hidden",name:"id",value:b.id},null,8,Tl)]))),128))],8,Il)],512))}},El={},Fl={width:"24",height:"24",version:"1.1",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ml=e("path",{d:"m0 18.316h2.5263v0.63158h-1.2632v1.2632h1.2632v0.63158h-2.5263v1.2632h3.7895v-5.0526h-3.7895zm1.2632-11.368h1.2632v-5.0526h-2.5263v1.2632h1.2632zm-1.2632 3.7895h2.2737l-2.2737 2.6526v1.1368h3.7895v-1.2632h-2.2737l2.2737-2.6526v-1.1368h-3.7895zm6.3158-7.5789v2.5263h17.684v-2.5263zm0 17.684h17.684v-2.5263h-17.684zm0-7.5789h17.684v-2.5263h-17.684z"},null,-1),Dl=[Ml];function Rl(o,t){return m(),x("svg",Fl,Dl)}var Ol=j(El,[["render",Rl]]);const Al={class:"new-item"},Nl=e("hr",null,null,-1),Vl=["disabled"],Pl=["value"],Bl=["innerHTML"],Ul={class:"tags"},jl=e("span",{class:"tag no-edit-mode"},"Tag 1",-1),Xl=e("span",{class:"tag no-edit-mode"},"Tag 2",-1),ql=e("span",{class:"tag no-edit-mode"},"Tag 3",-1),Hl=["disabled"],Wl=e("hr",null,null,-1),Kl={key:0,class:"tracking no-edit-mode"},Gl={class:"tracking-amount"},Jl={class:"unit"},Ql=e("label",null,"Add to diary",-1),Yl=e("hr",null,null,-1),Zl=["innerHTML"],ea=e("hr",null,null,-1),ta={class:"no-edit-mode"},na={class:"nutrient-block"},la={class:"col50"},aa={class:"unit"},oa={class:"unit"},sa={class:"col50"},ia={class:"unit"},ua={class:"unit"},ca=e("hr",null,null,-1),ra={class:"prep"},da=["disabled"],ma={class:"prep-size"},_a=["value"],va=["disabled"],ha=["value"],fa={class:"unit"},pa=["value"],ga={class:"unit"},ba=["value"],ya={class:"unit"},$a=["value"],wa={class:"unit"},ka={class:"placeholder"},xa={setup(o){const{t}=U(),i=X("log"),r=X("csrfToken");X("perms");const s=X("recipes"),u=p([]),a=p(null),d=p(!1),h=p(!1),y=p(!1),I=p(1),f=p("&nbsp;"),g=p(R.now().toISODate()),b=p(R.now().toLocaleString(R.TIME_24_SIMPLE)),z=p(null),c=p(null),w=p(null);function k(S,C=2){return+parseFloat(S/(a.value.size||1)).toFixed(C)}function $(S){return Math.min.apply(Math,s.value.map(C=>Math.floor(C[S]/C.size)))}function O(S){return Math.max.apply(Math,s.value.map(C=>Math.ceil(C[S]/C.size)))}function K(S){fetch("/api/v1/recipe",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({name:S})}).then(C=>{if(!C.ok)throw t("createrec.err"+C.status);return C.json()}).then(C=>{C.isowner=!0,s.value.push(C),u.value.push(C),i.msg(t("createrec.ok")),re(C.id)}).catch(C=>i.err(C))}function ne(){h.value=!0;let S=a.value.id,C=a.value.owner,D=a.value.isowner;fetch("/api/v1/recipe/"+S,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams(new FormData(c.value))}).then(T=>{if(!T.ok)throw t("saverec.err"+T.status);return G(S)}).then(()=>fetch("/api/v1/recipe/"+S)).then(T=>T.json()).then(T=>{T.owner=C,T.isowner=D,s.value=s.value.map(H=>T.id==H.id?T:H),u.value=u.value.map(H=>T.id==H.id?T:H),a.value=a.value.id==T.id?T:a.value,i.msg(t("saverec.ok"))}).catch(T=>i.err(T)).finally(()=>{setTimeout(function(){h.value=!1},500)})}function G(S){let C=w.value.getDiff();return C.length==0?new Promise(D=>{d.value=!1,D()}):new Promise((D,T)=>{let H=0,he;C.forEach($e=>{fetch(`/api/v1/recipe/${S}/ingredient/${$e.id}`,{method:"PUT",headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r},body:new URLSearchParams({amount:$e.amount})}).then(me=>{if(++H,!me.ok)throw t("saverec.err"+me.status)}).catch(me=>he=me).finally(()=>{H==C.length&&(he?T(he):(d.value=!1,D()))})})})}function ce(S,C){y.value=!0;let D=new URLSearchParams({recipe:a.value.name});a.value.items.forEach(T=>{D.append("id",T.id),D.append("amount",k(T.amount)*I.value),D.append("time",C)}),fetch(`/api/v1/diary/${S}`,{method:"POST",body:D,headers:{"Content-Type":"application/x-www-form-urlencoded","X-CSRF-Token":r}}).then(T=>{if(!T.ok)throw t("adddiary.err"+T.status);I.value=1,i.msg(t("adddiary.ok"))}).catch(T=>i.err(T)).finally(()=>{setTimeout(function(){y.value=!1},500)})}function re(S){a.value=u.value.filter(C=>C.id==S)[0],g.value=R.now().toISODate(),b.value=R.now().toLocaleString(R.TIME_24_SIMPLE),I.value=1,z.value.showDetails(),"isowner"in a.value?F():V()}function V(){fetch(`/api/v1/recipe/${a.value.id}/owner`).then(S=>{if(!S.ok)throw S;return S.json()}).then(S=>{a.value.isowner=S.isowner,a.value.owner=S.owner,F()}).catch(()=>{i.err(t("recowner.err")),f.value="&nbsp;"})}function F(){a.value.isowner?f.value=t("recipe.isowner"):a.value.owner?f.value=t("recipe.owner",{name:a.value.owner}):f.value=t("recipe.ispublic")}function v(S){u.value=S,a.value&&u.value.filter(C=>C.id==a.value.id).length==0&&(a.value=null)}function L(){d.value?ne():d.value=!0}function de(S){S.target.blur(),isNaN(parseFloat(S.target.value))&&(S.target.value=a.value[S.target.name])}return se(()=>u.value=[...s.value]),(S,C)=>(m(),N(te,{ref_key:"main",ref:z,onDetailVisibility:C[1]||(C[1]=D=>d.value=!1),class:P({"edit-mode":d.value})},xe({filter:M(()=>[e("section",Al,[e("h2",null,l(n(t)("aria.headnewrec")),1),_(Ie,{label:n(t)("btn.new"),placeholder:n(t)("recipe.hintnew"),onConfirm:K},null,8,["label","placeholder"])]),Nl,e("section",null,[e("h2",null,l(n(t)("aria.headsearch")),1),_(Ce,{data:n(s),placeholder:n(t)("recipe.hintsearch"),onResult:v},{default:M(D=>[e("fieldset",null,[_(A,{label:n(t)("food.energy"),min:$("kcal"),max:O("kcal"),onInput:D.confirm,name:"kcal",unit:"cal",frac:"0"},null,8,["label","min","max","onInput"]),_(A,{label:n(t)("food.fat"),min:$("fat"),max:O("fat"),onInput:D.confirm,name:"fat",unit:"g",frac:"0"},null,8,["label","min","max","onInput"]),_(A,{label:n(t)("food.carbs"),min:$("carb"),max:O("carb"),onInput:D.confirm,name:"carb",unit:"g",frac:"0"},null,8,["label","min","max","onInput"]),_(A,{label:n(t)("food.protein"),min:$("prot"),max:O("prot"),onInput:D.confirm,name:"prot",unit:"g",frac:"0"},null,8,["label","min","max","onInput"])])]),_:1},8,["data","placeholder"])])]),main:M(()=>[_(Le,{items:u.value,onSelected:re},null,8,["items"])]),_:2},[a.value?{name:"head-details",fn:M(()=>[e("form",{ref_key:"form",ref:c,autocomplete:"off",id:"form-recipe"},[e("fieldset",{disabled:!d.value},[e("input",{type:"text",name:"name",value:a.value.name},null,8,Pl)],8,Vl)],512)])}:void 0,a.value?{name:"details",fn:M(()=>[e("section",{class:"subtitle no-edit-mode",innerHTML:f.value},null,8,Bl),e("section",Ul,[jl,Xl,ql,a.value.isowner?(m(),x("button",{key:0,class:"icon async",disabled:h.value,onClick:L},[d.value?B("",!0):(m(),N(Te,{key:0})),d.value?(m(),N(ye,{key:1})):B("",!0)],8,Hl)):B("",!0)]),Wl,a.value.items.length?(m(),x("section",Kl,[e("h2",null,l(n(t)("aria.headtrack")),1),e("fieldset",Gl,[e("div",null,[e("label",null,l(n(t)("food.amount")),1),Q(e("input",{type:"number","onUpdate:modelValue":C[0]||(C[0]=D=>I.value=D),name:"amount"},null,512),[[be,I.value]]),e("span",Jl,l(n(t)("recipe.size",I.value)),1)])]),e("fieldset",null,[Ql,_(Se,{label:n(t)("btn.add"),time:b.value,date:g.value,disabled:y.value,onConfirm:ce},null,8,["label","time","date","disabled"])])])):B("",!0),Yl,e("section",null,[e("h2",null,l(n(t)("aria.headingred")),1),a.value.items.length?B("",!0):(m(),x("p",{key:0,class:"msg-noitems",innerHTML:n(t)("recipe.noitems")},null,8,Zl)),_(zl,{ref_key:"ingredients",ref:w,items:a.value.items,disabled:!d.value},null,8,["items","disabled"])]),ea,e("section",ta,[e("h2",null,l(n(t)("aria.headnutrients")),1),e("div",na,[e("div",la,[e("div",null,[e("label",null,l(n(t)("food.energy")),1),e("span",null,l(k(a.value.kcal,1)),1),e("span",aa,l(n(t)("unit.cal")),1)]),e("div",null,[e("label",null,l(n(t)("food.fat")),1),e("span",null,l(k(a.value.fat,1)),1),e("span",oa,l(n(t)("unit.g")),1)])]),e("div",sa,[e("div",null,[e("label",null,l(n(t)("food.carbs2")),1),e("span",null,l(k(a.value.carb,1)),1),e("span",ia,l(n(t)("unit.g")),1)]),e("div",null,[e("label",null,l(n(t)("food.protein")),1),e("span",null,l(k(a.value.prot,1)),1),e("span",ua,l(n(t)("unit.g")),1)])])])]),ca,e("section",ra,[e("h2",null,l(n(t)("aria.headprep")),1),e("div",null,[e("fieldset",{disabled:!d.value,class:"col50"},[e("div",ma,[e("label",null,l(n(t)("recipe.size",2)),1),e("input",{type:"text",name:"size",form:"form-recipe",value:a.value.size,onChange:de},null,40,_a),e("label",null,l(n(t)("recipe.size",a.value.size)),1)])],8,da),e("fieldset",{disabled:!d.value,class:"col50"},[e("div",null,[e("label",null,l(n(t)("recipe.time")),1),e("input",{type:"text",disabled:"",value:a.value.preptime+a.value.cooktime+a.value.misctime},null,8,ha),e("span",fa,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.preptime")),1),e("input",{type:"text",name:"preptime",form:"form-recipe",value:a.value.preptime,onChange:de},null,40,pa),e("span",ga,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.cooktime")),1),e("input",{type:"text",name:"cooktime",form:"form-recipe",value:a.value.cooktime,onChange:de},null,40,ba),e("span",ya,l(n(t)("unit.min")),1)]),e("div",null,[e("label",null,l(n(t)("recipe.misctime")),1),e("input",{type:"text",name:"misctime",form:"form-recipe",value:a.value.misctime,onChange:de},null,40,$a),e("span",wa,l(n(t)("unit.min")),1)])],8,va)]),e("div",ka,[_(Ol),e("p",null,l(n(t)("todo.instructions")),1)])])])}:void 0]),1032,["class"]))}};const Ca=["disabled"],Ia={value:"1"},Sa={value:"2"},La={value:"3"},Ta={value:"4"},za={value:"5"},Ea={value:"6"},Fa={value:"7"},Ma={value:"8"},Da={value:"9"},Ra={value:"10"},Oa={value:"11"},Aa={value:"12"},Na=["value"],Va=["disabled"],ze={props:["mode"],emits:["selection"],setup(o,{emit:t}){const i=o,{t:r}=U(),s=p([2020,2021,2022,2023]),u=p(["2022-03-12","2022-03-14","2022-03-15","2022-03-16"]),a=p(R.now().month),d=p(R.now().year),h=p(null),y=oe(()=>d.value!=s.value[0]||a.value>1),I=oe(()=>d.value!=s.value[s.value.length-1]||a.value<12);let f=[];function g(){let w=R.now().toISODate(),k=R.local(d.value,a.value);k=k.minus({days:k.weekday}),h.value.querySelectorAll("td").forEach($=>{let O=k.toISODate();$.firstElementChild.textContent=k.day,$.firstElementChild.dataset.date=O,k.month!=a.value?$.classList.add("outside"):$.classList.remove("outside"),O==w?$.classList.add("today"):$.classList.remove("today"),u.value.indexOf(O)!=-1?$.classList.add("has-entries"):$.classList.remove("has-entries"),f.indexOf(O)!=-1?$.classList.add("active"):$.classList.remove("active"),k=k.plus({days:1})})}function b(){--a.value<1&&(a.value=12,--d.value),g()}function z(){++a.value>12&&(a.value=1,++d.value),g()}function c(w){let k=w.target.dataset.date;if(i.mode=="toggle"){let $=f.indexOf(k);$==-1?f.push(k):f.splice($,1)}else f=[k];h.value.querySelectorAll("td>button").forEach($=>{f.indexOf($.dataset.date)!=-1?$.parentNode.classList.add("active"):$.parentNode.classList.remove("active")}),t("selection",f)}return se(()=>g()),(w,k)=>(m(),x("div",{class:P(["calendar",[o.mode]])},[e("div",null,[e("button",{class:"prev icon",onClick:b,disabled:!n(y)},[_(_e)],8,Ca),e("div",null,[Q(e("select",{class:"month","onUpdate:modelValue":k[0]||(k[0]=$=>a.value=$),onChange:g},[e("option",Ia,l(n(r)("month.1")),1),e("option",Sa,l(n(r)("month.2")),1),e("option",La,l(n(r)("month.3")),1),e("option",Ta,l(n(r)("month.4")),1),e("option",za,l(n(r)("month.5")),1),e("option",Ea,l(n(r)("month.6")),1),e("option",Fa,l(n(r)("month.7")),1),e("option",Ma,l(n(r)("month.8")),1),e("option",Da,l(n(r)("month.9")),1),e("option",Ra,l(n(r)("month.10")),1),e("option",Oa,l(n(r)("month.11")),1),e("option",Aa,l(n(r)("month.12")),1)],544),[[pe,a.value,void 0,{number:!0}]]),Q(e("select",{class:"year","onUpdate:modelValue":k[1]||(k[1]=$=>d.value=$),onChange:g},[(m(!0),x(ee,null,ie(s.value,$=>(m(),x("option",{value:$},l($),9,Na))),256))],544),[[pe,d.value,void 0,{number:!0}]])]),e("button",{class:"next icon",onClick:z,disabled:!n(I)},[_(_e)],8,Va)]),e("table",{ref_key:"calendar",ref:h},[e("thead",null,[e("tr",null,[e("th",null,l(n(r)("day.cal7")),1),e("th",null,l(n(r)("day.cal1")),1),e("th",null,l(n(r)("day.cal2")),1),e("th",null,l(n(r)("day.cal3")),1),e("th",null,l(n(r)("day.cal4")),1),e("th",null,l(n(r)("day.cal5")),1),e("th",null,l(n(r)("day.cal6")),1)])]),e("tbody",null,[e("tr",null,[e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})])]),e("tr",null,[e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})])]),e("tr",null,[e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})])]),e("tr",null,[e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})])]),e("tr",null,[e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})])]),e("tr",null,[e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})]),e("td",null,[e("button",{onClick:c})])])])],512)],2))}},Pa=e("hr",null,null,-1),Ba=e("section",null,null,-1),Ua=E(" Diary "),ja={setup(o){const{t}=U(),i=p(null);function r(s){console.log(s)}return(s,u)=>(m(),N(te,{ref_key:"main",ref:i},{filter:M(()=>[e("section",null,[e("h2",null,l(n(t)("aria.headcal")),1),_(ze,{onSelection:r})]),Pa,Ba]),main:M(()=>[Ua]),_:1},512))}},Xa=e("hr",null,null,-1),qa=e("section",null,null,-1),Ha=E(" Shopping Lists "),Wa={setup(o){const{t}=U(),i=p(null);function r(s){console.log(s)}return(s,u)=>(m(),N(te,{ref_key:"main",ref:i},{filter:M(()=>[e("section",null,[e("h2",null,l(n(t)("aria.headcal")),1),_(ze,{mode:"toggle",onSelection:r})]),Xa,qa]),main:M(()=>[Ha]),_:1},512))}},Ka=E(" Profile "),Ga={setup(o){return(t,i)=>(m(),N(te,null,{main:M(()=>[Ka]),_:1}))}},Ja=E(" Settings "),Qa={setup(o){return(t,i)=>(m(),N(te,null,{main:M(()=>[Ja]),_:1}))}},Ya=Fe({history:Me(),routes:[{path:"/",name:"diary",component:ja},{path:"/recipes",name:"recipes",component:xa},{path:"/food",name:"food",component:Cl},{path:"/shopping",name:"shopping",component:Wa},{path:"/profile",name:"profile",component:Ga},{path:"/settings",name:"settings",component:Qa}]});let ge=document.documentElement.lang||navigator.language;!ge&&navigator.languages!=null&&(ge=navigator.languages[0]);const ke=document.querySelector("meta[name='_csrf']"),Za=ke?ke.content:"",eo=function(){const o=document.documentElement.dataset.perm||1,t=65536,i=131072;function r(s){return(o&s)==s}return{canCreateFood:r(t),canEditFood:r(i)}}(),to=function(){function o(t){return typeof t=="string"?t:"message"in t?t.message:W.global.t("err.err")}return{msg:function(t){let i={msg:o(t),timeout:3e3};window.dispatchEvent(new CustomEvent("message",{detail:i}))},warn:function(t){let i={msg:o(t),timeout:4e3};window.dispatchEvent(new CustomEvent("warning",{detail:i}))},err:function(t){let i={msg:o(t),timeout:5e3};window.dispatchEvent(new CustomEvent("error",{detail:i}))}}}(),q=De(yt);let W,Y,ue,Z;function no(o){W=Re({legacy:!1,locale:ge.split("-")[0],fallbackLocale:"en",messages:o}),Y&&ue&&Z&&ve()}function lo(o){Y=o,W&&ue&&Z&&ve()}function ao(o){ue=o,W&&Y&&Z&&ve()}function oo(o){Z={},o.forEach(t=>Z[t.date]=t),W&&Y&&ue&&ve()}function ve(){Y.forEach(o=>{o.name=W.global.t(o.id.toString())}),q.provide("csrfToken",Za),q.provide("perms",eo),q.provide("food",p(Y)),q.provide("recipes",p(ue)),q.provide("diary",p(Z)),q.provide("log",to),q.use(Ya),q.use(W),q.mount("#app")}fetch("/app/l10n.json").then(o=>o.json()).then(no);fetch("api/v1/foods").then(o=>o.json()).then(lo);fetch("api/v1/recipes").then(o=>o.json()).then(ao);fetch("api/v1/diary").then(o=>o.json()).then(oo);
